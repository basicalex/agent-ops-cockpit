#!/usr/bin/env bash
set -euo pipefail

confirm=0
if [[ "${1:-}" == "--yes" ]]; then
  confirm=1
fi

state_dir="${XDG_STATE_HOME:-$HOME/.local/state}/aoc"

files=(
  "$HOME/.local/bin/aoc-sys"
  "$HOME/.local/bin/aoc-taskmaster"
  "$HOME/.local/bin/aoc-hub"
  "$HOME/.local/bin/aoc-mission-control"
  "$HOME/.local/bin/aoc-mission-control-native"
  "$HOME/.local/bin/aoc-mission-control-toggle"
  "$HOME/.local/bin/aoc-test"
  "$HOME/.local/bin/aoc-widget"
  "$HOME/.local/bin/aoc-widget-set"
  "$HOME/.local/bin/aoc-open-explorer"
  "$HOME/.local/bin/aoc-open-file"
  "$HOME/.local/bin/aoc-yazi"
  "$HOME/.local/bin/aoc-preview"
  "$HOME/.local/bin/aoc-preview-set"
  "$HOME/.local/bin/aoc-preview-toggle"
  "$HOME/.local/bin/aoc-doctor"
  "$HOME/.local/bin/aoc-launch"
  "$HOME/.local/bin/aoc-watcher"
  "$HOME/.local/bin/aoc-init"
  "$HOME/.local/bin/aoc-mem"
  "$HOME/.local/bin/aoc-align"
  "$HOME/.local/bin/aoc-uninstall"
  "$HOME/.config/zellij/layouts/aoc.kdl"
  "$HOME/.config/zellij/layouts/aoc.plugin.kdl"
  "$HOME/.config/zellij/layouts/aoc-plugin.kdl"
  "$HOME/.config/zellij/aoc.config.kdl"
  "$HOME/.config/yazi/yazi.toml"
  "$HOME/.config/yazi/preview.sh"
  "$HOME/.config/yazi/keymap.toml"
  "$HOME/.config/yazi/plugins/aoc-preview-toggle.yazi"
)

echo "This will remove AOC-installed files from your home directory."
if [[ "$confirm" -eq 0 ]]; then
  read -r -p "Continue? [y/N] " ans
  [[ "${ans,,}" == "y" ]] || exit 0
fi

for f in "${files[@]}"; do
  if [[ -e "$f" ]]; then
    if [[ -d "$f" ]]; then
      rm -rf "$f"
    else
      rm -f "$f"
    fi
    echo "Removed: $f"
  fi
done

if [[ -d "$state_dir" ]]; then
  rm -rf "$state_dir"
  echo "Removed: $state_dir"
fi
