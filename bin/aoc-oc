#!/usr/bin/env bash
set -euo pipefail

agent_id="oc"
agent_bin="${AOC_OC_BIN:-opencode}"
agent_label="OpenCode"

if [[ "${AOC_AGENT_RUN:-0}" == "1" ]]; then
  exec aoc-agent-wrap "$agent_id" "$agent_bin" "$agent_label" "$@"
fi

if [[ -n "${ZELLIJ:-}" || -n "${ZELLIJ_SESSION_NAME:-}" ]]; then
  AOC_AGENT_ID="$agent_id" aoc-new-tab --aoc --name "$agent_label" "$@"
else
  AOC_AGENT_ID="$agent_id" aoc-launch
fi
