{
  "pulse-hub-spoke": {
    "tasks": [
      {
        "id": "62",
        "title": "Define Pulse vNext architecture and PRD",
        "description": "Define implementation spec for passive hub and active wrapper telemetry",
        "details": "Write a task-level PRD for Pulse vNext architecture. Cover: problem statement, constraints (no pane focus-hopping, no MITM terminal proxy), data flow, module boundaries, failure modes, migration plan from current websocket-first path, and explicit non-goals. Include UX requirements for near-real-time updates and deterministic tab lifecycle behavior.",
        "testStrategy": "Review PRD with implementation team and confirm every required component has acceptance criteria, risks, and measurable latency targets.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": {
          "path": ".taskmaster/docs/prds/62-define-pulse-vnext-architecture-and-prd.md",
          "updatedAt": "2026-02-07T20:27:03.998Z",
          "version": 1
        },
        "updatedAt": "2026-02-07T20:27:03.998Z",
        "activeAgent": false
      },
      {
        "id": "63",
        "title": "Implement shared Pulse IPC module in Rust",
        "description": "Create shared NDJSON protocol types and framing utilities",
        "details": "Add a shared IPC module in Rust (prefer aoc-core) for Pulse messages. Define WireMsg variants for Hello, Subscribe, Snapshot, Delta, Heartbeat, Command, and CommandResult. Implement robust newline-delimited JSON framing, max message size guards, serde schema tests, backward-compatible version field handling, and protocol docs with example payloads.",
        "testStrategy": "Add unit tests for encode/decode, malformed JSON recovery, oversized payload rejection, and round-trip compatibility for all message variants.",
        "status": "done",
        "dependencies": [
          "62"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-07T20:38:23.144Z",
        "activeAgent": false
      },
      {
        "id": "64",
        "title": "Implement Pulse UDS hub state service",
        "description": "Build UDS hub daemon with snapshot and delta broadcasting",
        "details": "Extend aoc-hub-rs with a Unix Domain Socket server for local Pulse clients. Maintain a session-scoped in-memory StateStore keyed by session_id::pane_id, plus per-subscriber fanout channels. On connect: handshake validation, send full snapshot, then stream deltas. Add heartbeat tracking, stale-agent eviction, reconnect handling, and bounded queues with drop/slow-consumer policies.",
        "testStrategy": "Integration-test multiple subscribers and publishers in one session: verify snapshot-on-connect, ordered deltas, stale eviction, and no cross-session leakage.",
        "status": "done",
        "dependencies": [
          "62",
          "63"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-07T20:49:18.795Z",
        "activeAgent": false
      },
      {
        "id": "65",
        "title": "Implement hub layout watcher for pane lifecycle",
        "description": "Add fast layout watcher and immediate pane-close pruning",
        "details": "Implement a lightweight zellij layout watcher loop in aoc-hub-rs (target tick 200-300ms) that parses dump-layout pane/tab topology and emits pane_opened/pane_closed events. On pane_closed, prune matching agent state immediately and broadcast delta updates. Include debounce/backoff on command failure and metrics for watcher jitter and parse errors.",
        "testStrategy": "Simulate rapid tab open/close churn and verify agent rows are removed within target latency without false positives or UI flicker.",
        "status": "done",
        "dependencies": [
          "64"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-07T20:49:18.803Z",
        "activeAgent": false
      },
      {
        "id": "66",
        "title": "Implement wrapper transparent tap and debounced state reporter",
        "description": "Implement transparent tap reporter in aoc-agent-wrap-rs",
        "details": "Refactor wrapper telemetry to keep terminal passthrough transparent while capturing a bounded ring buffer copy of output for analysis. Add debounced state reporter (250ms cadence with content hash and significant-change detection), parser heuristics for busy/idle/error/needs-input, and confidence/hysteresis to prevent flapping. Ensure parser work is off the hot I/O path.",
        "testStrategy": "Add PTY integration tests that assert no interaction regression (keyboard/mouse passthrough), while state updates emit only on change or debounce boundary.",
        "status": "done",
        "dependencies": [
          "62",
          "63"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-07T20:52:50.774Z",
        "activeAgent": false
      },
      {
        "id": "67",
        "title": "Implement command routing and SIGINT-safe agent control",
        "description": "Implement command path and robust signal forwarding",
        "details": "Implement Pulse command flow as client -> hub -> wrapper, not zellij write-chars. Support at minimum: focus_tab (hub action), stop_agent (wrapper-injected Ctrl-C), and soft command acknowledgements. Ensure SIGINT handling forwards to child PTY first, then escalates if child does not exit in timeout window. Include command auth/session checks and idempotency semantics.",
        "testStrategy": "Automated tests for Ctrl-C propagation, timeout escalation, and command ack/error responses across disconnected/reconnecting wrappers.",
        "status": "done",
        "dependencies": [
          "64",
          "66"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-07T21:07:22.537Z",
        "activeAgent": false
      },
      {
        "id": "68",
        "title": "Integrate mission-control with Pulse UDS protocol",
        "description": "Integrate aoc-mission-control Pulse client with new UDS stream",
        "details": "Add Pulse client transport in aoc-mission-control to consume snapshot+deltas from hub UDS with fast reconciliation. Preserve fallback paths when hub unavailable and ensure mode rendering remains deterministic. Wire overview row selection, attention sorting, and command dispatch to new command channel. Add reconnect logic with stale-state clearing and status messaging.",
        "testStrategy": "Run end-to-end session tests with hub restarts, wrapper reconnects, and tab closures; verify UI remains consistent and updates within target latency budgets.",
        "status": "done",
        "dependencies": [
          "64",
          "65",
          "66",
          "67"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-07T21:33:52.569Z",
        "activeAgent": false
      },
      {
        "id": "69",
        "title": "Add observability and rollout plan for Pulse vNext",
        "description": "Ship telemetry, benchmarks, and rollout safeguards for Pulse vNext",
        "details": "Add structured metrics/logging for end-to-end latency (wrapper emit -> hub delta -> pulse render), queue drops, parser confidence transitions, and watcher health. Build a stress benchmark for 5-20 agents to validate CPU and memory budgets. Add feature flag/rollback path to keep current behavior available during rollout.",
        "testStrategy": "CI/local benchmark run with synthetic agent output and tab churn; assert latency and resource thresholds plus clean rollback behavior.",
        "status": "done",
        "dependencies": [
          "64",
          "66",
          "68"
        ],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-07T21:51:33.639Z",
        "activeAgent": false
      }
    ]
  },
  "sub-agents": {
    "tasks": [
      {
        "id": "56",
        "title": "Define sub-agent catalog and prompt templates",
        "description": "Confirm names, intents, and template format for the planned sub-agents.",
        "details": "Define the canonical sub-agent list and default rotation order.\n- Confirm names and intents for: architect, task-breaker, implementer, test-planner, code-reviewer, docs-maintainer, security-reviewer, perf-analyzer, release-notes, incident-debugger, rlm-curator.\n- Specify template fields (goal, scope, constraints, inputs, output format).\n- Define naming rules and file locations: .opencode/agents/<name>.md.\n- Decide opt-in or opt-out flags and a default rotation order.",
        "testStrategy": "Review the catalog and template spec in docs/agents.md.\nCreate a sample agent file and confirm OpenCode can invoke it with @name.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-04T11:18:59.149Z",
        "activeAgent": false
      },
      {
        "id": "57",
        "title": "Seed sub-agents via aoc-init",
        "description": "Ensure aoc-init seeds the sub-agent templates safely.",
        "details": "Update aoc-init to seed sub-agent templates if missing.\n- Create .opencode/agents if needed.\n- Write templates for each sub-agent from the approved catalog.\n- Do not overwrite existing user edits.\n- Add a config file for ordering if required (for example .opencode/sub-agents.json).\n- Keep behavior idempotent across multiple runs.",
        "testStrategy": "Run aoc-init in a clean repo and confirm all templates and config files are created.\nRe-run aoc-init and confirm existing files are not overwritten.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-04T11:18:59.157Z",
        "activeAgent": false
      },
      {
        "id": "58",
        "title": "Define sub-agent rotation config and state",
        "description": "Specify how rotation order and active agent state are stored.",
        "details": "Design the configuration and state model for sub-agent rotation.\n- Define config schema (order, enabled list, default agent).\n- Decide where per-tab or per-session selection is stored.\n- Define environment variables or commands the OpenCode plugin will use to set active sub-agent.\n- Document fallback behavior when config is missing or invalid.",
        "testStrategy": "Document the schema with a sample config and confirm it covers ordering and enablement.\nValidate the fallback rules against an empty or invalid config.",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-04T11:18:59.164Z",
        "activeAgent": false
      },
      {
        "id": "59",
        "title": "Implement OpenCode Shift+Tab sub-agent rotation",
        "description": "Add the OpenCode CLI plugin that rotates sub-agents.",
        "details": "Implement the OpenCode CLI plugin to rotate sub-agents on Shift+Tab.\n- Preserve Tab for plan/build switching.\n- Shift+Tab cycles through configured sub-agents in order.\n- Update the active sub-agent selection and expose it to the UI.\n- Provide a safe fallback when config or agent files are missing.",
        "testStrategy": "Manual: open OpenCode in AOC, press Shift+Tab, and verify the active sub-agent cycles.\nManual: Tab continues to toggle plan/build with no conflicts.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-04T11:18:59.170Z",
        "activeAgent": true
      },
      {
        "id": "60",
        "title": "Surface active sub-agent in AOC wrappers",
        "description": "Expose the active sub-agent through AOC wrapper scripts.",
        "details": "Update AOC wrappers to surface the active sub-agent.\n- Update aoc-agent-wrap header to show the active sub-agent name.\n- Pass the active sub-agent value to OpenCode via env or args.\n- Keep backward compatibility when the plugin is not installed.",
        "testStrategy": "Start AOC without the plugin and verify no errors occur.\nStart AOC with the plugin and confirm the header updates when the active sub-agent changes.",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-04T11:18:59.178Z",
        "activeAgent": false
      },
      {
        "id": "61",
        "title": "Document sub-agent rotation UX",
        "description": "Document the catalog, rotation keybind, and setup.",
        "details": "Update documentation for sub-agent rotation.\n- Expand docs/agents.md with the final catalog and usage.\n- Add README or docs/configuration notes for Shift+Tab rotation and config file location.\n- Provide a minimal example that shows how to invoke @agent and how rotation order is defined.",
        "testStrategy": "Doc review for consistency across agents docs, README, and configuration references.",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-04T11:18:59.185Z",
        "activeAgent": false
      }
    ],
    "aocPrd": {
      "path": ".taskmaster/docs/prds/insight-subagent-orchestration_prd_rpg.md",
      "updatedAt": "2026-02-27T08:28:35.444Z",
      "version": 1
    }
  },
  "safety": {
    "tasks": [
      {
        "id": "77",
        "title": "Add CI safety gates for Rust and shell",
        "description": "Gate regressions in PRs by enforcing tests and lint checks.",
        "details": "Update CI to run cargo test --workspace, cargo clippy --workspace --all-targets -- -D warnings, and rustfmt checks in addition to existing build and shell lint steps.",
        "testStrategy": "Open a PR with an intentional warning/lint failure and verify CI blocks merge; verify clean branch passes all gates.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-20T08:27:34.225Z",
        "activeAgent": false
      },
      {
        "id": "78",
        "title": "Fix installer smoke tests to validate PR code",
        "description": "Ensure installer workflows test the code under review, not hardcoded main.",
        "details": "Update installer smoke workflow to fetch bootstrap/install assets from the PR SHA or ref in pull_request context; keep main/tag behavior for push and release contexts.",
        "testStrategy": "Run workflow on a PR that changes install/bootstrap.sh and confirm the smoke job executes updated PR logic.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-20T08:34:03.258Z",
        "activeAgent": false
      },
      {
        "id": "79",
        "title": "Expand shellcheck coverage to all shipped scripts",
        "description": "Increase shell lint coverage for operational scripts.",
        "details": "Replace static file list in scripts/lint.sh with discovery of executable shell scripts in bin/ and install/, including aoc-agent-wrap, aoc-cleanup, aoc-theme, and aoc-utils.sh; keep any needed excludes explicit and documented.",
        "testStrategy": "Run lint locally and in CI; verify newly included scripts are checked and failures are reported.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-20T08:27:34.232Z",
        "activeAgent": false
      },
      {
        "id": "80",
        "title": "Add shell integration smoke tests for critical entrypoints",
        "description": "Create executable safety net for core shell flows.",
        "details": "Add non-interactive smoke tests for aoc-launch, aoc-new-tab, aoc-hub, aoc-mission-control-toggle, and aoc-agent-wrap in a controlled test harness with mocked dependencies where needed.",
        "testStrategy": "Run test suite in CI and verify basic command behavior, exit codes, and no unbound variable regressions.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-20T08:27:34.255Z",
        "activeAgent": false
      },
      {
        "id": "81",
        "title": "Add cross-process locking for task state writes",
        "description": "Prevent lost updates in concurrent task operations.",
        "details": "Implement file locking around read-modify-write paths for .taskmaster/tasks/tasks.json and .taskmaster/state.json in both aoc-cli and aoc-taskmaster, while preserving atomic temp-file rename semantics.",
        "testStrategy": "Concurrent writer test: run two task mutations in parallel and verify both updates persist without JSON corruption.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-20T16:33:33.181Z",
        "activeAgent": false
      },
      {
        "id": "82",
        "title": "Add file locking to aoc-mem append operations",
        "description": "Make memory append operations safe under concurrency.",
        "details": "Wrap aoc-mem add writes with flock (or robust fallback) and preserve append-only behavior for .aoc/memory.md across simultaneous agent writes.",
        "testStrategy": "Execute concurrent aoc-mem add calls and verify all entries appear intact and ordered by timestamp.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-20T16:33:33.190Z",
        "activeAgent": false
      },
      {
        "id": "83",
        "title": "Refactor aoc-agent-wrap cleanup to process-group lifecycle control",
        "description": "Reduce orphaned process risk and simplify cleanup behavior.",
        "details": "Move from broad /proc scanning kill logic to process-group-based child lifecycle management with deterministic signal escalation and clear ownership boundaries per pane instance.",
        "testStrategy": "Spawn nested child processes from wrapped agent, terminate pane/session, and verify full process tree exits with no long-lived leftovers.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-20T17:22:35.982Z",
        "activeAgent": false
      },
      {
        "id": "84",
        "title": "Extract aoc-cleanup Python heredoc into standalone module",
        "description": "Improve maintainability and testability of cleanup logic.",
        "details": "Move embedded Python from bin/aoc-cleanup into a dedicated script/module file, add unit-style tests for core selection logic, and keep CLI behavior backward compatible.",
        "testStrategy": "Run cleanup in dry-run and execute modes before/after refactor and diff the resulting target selection output.",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-20T17:22:35.989Z",
        "activeAgent": false
      },
      {
        "id": "85",
        "title": "Add telemetry secret redaction before broadcast",
        "description": "Prevent accidental sensitive data leakage through telemetry channels.",
        "details": "Add redaction filters in aoc-agent-wrap-rs output/tap pipeline before publishing to Pulse/WebSocket, covering common credential patterns and allowing safe extension.",
        "testStrategy": "Feed known secret-like strings through telemetry path and verify published payloads contain redacted tokens only.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-20T07:41:24.309Z",
        "activeAgent": false
      }
    ]
  },
  "omo": {
    "tasks": [
      {
        "id": "91",
        "title": "Establish sandbox OpenCode profile manager for OmO integration",
        "description": "Create deterministic sandbox profile conventions using OPENCODE_CONFIG_DIR to keep OmO setup isolated from primary user profile.",
        "details": "Implement profile path resolution, safe initialization, and explicit promotion/rollback primitives so OmO can be trialed without mutating the main OpenCode profile.",
        "testStrategy": "Add shell tests for idempotent profile initialization, profile resolution, and non-destructive behavior when profile directories already exist.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Define sandbox profile directory contract",
            "description": "Specify profile roots, naming, and environment variables (including OPENCODE_CONFIG_DIR) for stable sandbox selection.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 2,
            "title": "Implement profile init and resolve helpers",
            "description": "Create helper commands/scripts to initialize profile directories idempotently and resolve active profile path.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 3,
            "title": "Implement promotion and rollback safeguards",
            "description": "Add explicit promote/rollback flow with backup snapshots to prevent accidental primary profile corruption.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 4,
            "title": "Add profile isolation test fixtures",
            "description": "Create shell fixtures that verify re-runs are non-destructive and isolated from default profile.",
            "status": "pending",
            "dependencies": []
          }
        ],
        "aocPrd": {
          "path": ".taskmaster/docs/prds/omo-integration_prd_rpg.md",
          "updatedAt": "2026-02-22T15:30:18.275Z",
          "version": 1
        },
        "updatedAt": "2026-02-23T08:09:30.233Z",
        "activeAgent": false
      },
      {
        "id": "92",
        "title": "Install Oh-My-OpenCode in sandbox profile with provider-safe merge",
        "description": "Add OmO installation orchestration that targets sandbox profile and preserves existing provider/plugin entries like antigravity auth.",
        "details": "Implement install wrapper logic for non-interactive setup, plugin registration checks, and profile-local validation that OmO is present without clobbering current auth/providers.",
        "testStrategy": "Use fixture profiles to verify plugin array merge behavior and ensure existing provider blocks remain unchanged after install.",
        "status": "done",
        "dependencies": [
          "91"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Create sandbox-targeted OmO installer wrapper",
            "description": "Add install script that runs OmO installer against sandbox profile without mutating primary profile.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 2,
            "title": "Implement plugin/provider merge-safe updates",
            "description": "Ensure existing plugins/providers (including antigravity auth) are preserved when registering OmO.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 3,
            "title": "Support non-interactive provider flag flow",
            "description": "Map install-time provider/subscription flags into deterministic script options for repeatable setup.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 4,
            "title": "Add post-install sandbox health check",
            "description": "Verify OmO plugin registration and expected config files in sandbox profile after install.",
            "status": "pending",
            "dependencies": []
          }
        ],
        "aocPrd": {
          "path": ".taskmaster/docs/prds/omo-integration_prd_rpg.md",
          "updatedAt": "2026-02-22T15:30:24.245Z",
          "version": 1
        },
        "updatedAt": "2026-02-23T08:09:30.263Z",
        "activeAgent": false
      },
      {
        "id": "93",
        "title": "Define project-local OmO control policy configuration",
        "description": "Create .opencode/oh-my-opencode.jsonc policy defaults that keep OmO additive, deterministic, and engineer-controlled.",
        "details": "Disable autonomous loop/continuation-heavy features by default, keep high-value additive capabilities enabled, and set conservative concurrency/fallback limits.",
        "testStrategy": "Add config fixture assertions for required disabled/enabled keys and verify generated policy remains schema-compatible with current OmO versions.",
        "status": "done",
        "dependencies": [
          "92"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Create project-local OmO policy template",
            "description": "Add .opencode/oh-my-opencode.jsonc baseline template aligned to AOC governance expectations.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 2,
            "title": "Disable loop-heavy and low-control defaults",
            "description": "Turn off continuation/loop features and keyword auto-escalation paths that reduce engineer control.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 3,
            "title": "Set additive agent and concurrency defaults",
            "description": "Keep valuable capabilities enabled while enforcing conservative background concurrency and fallback bounds.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 4,
            "title": "Add config compatibility checks",
            "description": "Validate policy template against OmO schema and verify compatibility with current OpenCode profile format.",
            "status": "pending",
            "dependencies": []
          }
        ],
        "aocPrd": {
          "path": ".taskmaster/docs/prds/omo-integration_prd_rpg.md",
          "updatedAt": "2026-02-22T15:30:24.258Z",
          "version": 1
        },
        "updatedAt": "2026-02-23T08:09:30.305Z",
        "activeAgent": false
      },
      {
        "id": "94",
        "title": "Enforce Taskmaster as sole task authority for OmO workflows",
        "description": "Ensure OmO runtime and prompts use tm/aoc-task only and do not activate parallel task systems.",
        "details": "Keep experimental task system disabled, inject policy guidance for delegated agents, and add conflict detection for accidental writes to .sisyphus/tasks.",
        "testStrategy": "Run smoke checks that execute representative workflows and assert no task artifacts are created outside Taskmaster state.",
        "status": "done",
        "dependencies": [
          "93"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Disable OmO task system by policy",
            "description": "Set and enforce experimental.task_system=false in effective OmO configuration.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 2,
            "title": "Inject Taskmaster-only task guidance",
            "description": "Add policy text to agent prompts/contracts requiring tm or aoc-task for all task lifecycle operations.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 3,
            "title": "Add conflict detection for non-Taskmaster task writes",
            "description": "Implement checks that fail fast when .sisyphus/tasks artifacts are created during workflows.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 4,
            "title": "Validate delegated-agent task compliance",
            "description": "Confirm subagent/delegated paths preserve Taskmaster-only behavior.",
            "status": "pending",
            "dependencies": []
          }
        ],
        "aocPrd": {
          "path": ".taskmaster/docs/prds/omo-integration_prd_rpg.md",
          "updatedAt": "2026-02-22T15:30:24.269Z",
          "version": 1
        },
        "updatedAt": "2026-02-23T08:09:30.370Z",
        "activeAgent": false
      },
      {
        "id": "95",
        "title": "Implement AOC context-pack bridge for OmO sessions",
        "description": "Compose bounded OmO context payloads from aoc-mem, aoc-stm, and aoc-mind with strict precedence and size limits.",
        "details": "Add scripts/helpers that build deterministic context packs and keep AGENTS.md procedural while durable knowledge remains in .aoc artifacts.",
        "testStrategy": "Use fixture outputs to verify precedence order (mem -> stm -> mind), bounded length, and stable formatting for repeated inputs.",
        "status": "done",
        "dependencies": [
          "93"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Define context-pack contract and budgets",
            "description": "Specify context precedence, section layout, and max-size limits for mem/stm/mind payload composition.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 2,
            "title": "Implement context pack composer utility",
            "description": "Build script/helper that reads AOC memory sources and emits bounded deterministic context text.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 3,
            "title": "Integrate context pack into OmO startup workflow",
            "description": "Wire generated context pack into project-local agent flows without duplicating AGENTS/README injection.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 4,
            "title": "Add fixture tests for ordering and bounds",
            "description": "Test deterministic output ordering (mem -> stm -> mind) and strict line/size limits.",
            "status": "pending",
            "dependencies": []
          }
        ],
        "aocPrd": {
          "path": ".taskmaster/docs/prds/omo-integration_prd_rpg.md",
          "updatedAt": "2026-02-22T15:30:24.292Z",
          "version": 1
        },
        "updatedAt": "2026-02-23T08:09:30.436Z",
        "activeAgent": false
      },
      {
        "id": "96",
        "title": "Integrate OmO provisioning into install.sh and aoc-init",
        "description": "Wire sandbox-first OmO setup into standard install and project initialization flows with idempotent behavior.",
        "details": "Extend installer/init scripts to seed profile/project policy files safely, preserve existing user customizations, and expose clear logs for profile mode and governance state.",
        "testStrategy": "Run repeated install/init executions in temp HOME/project fixtures and assert outputs are stable with no destructive drift.",
        "status": "done",
        "dependencies": [
          "92",
          "94",
          "95"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Add OmO sandbox options to install.sh",
            "description": "Introduce installer controls for OmO enablement mode, profile target, and non-interactive install flags.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 2,
            "title": "Seed OmO config artifacts during install",
            "description": "Install template/policy files and profile metadata safely during bootstrap without clobbering user data.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 3,
            "title": "Extend aoc-init to seed project OmO policy",
            "description": "Ensure aoc-init creates or repairs project-local OmO policy files and governance guidance idempotently.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 4,
            "title": "Add install/init idempotency regressions",
            "description": "Verify repeated install/init runs remain stable and non-destructive across profile states.",
            "status": "pending",
            "dependencies": []
          }
        ],
        "aocPrd": {
          "path": ".taskmaster/docs/prds/omo-integration_prd_rpg.md",
          "updatedAt": "2026-02-22T15:30:24.305Z",
          "version": 1
        },
        "updatedAt": "2026-02-23T08:09:30.472Z",
        "activeAgent": false
      },
      {
        "id": "97",
        "title": "Expand smoke and regression validation for OmO+AOC policy invariants",
        "description": "Add automated checks for profile isolation, disabled loop-heavy defaults, Taskmaster authority, and context-pack bounds.",
        "details": "Extend scripts/smoke.sh and add focused verify scripts to catch policy regressions before release.",
        "testStrategy": "Require AOC_SMOKE_TEST=1 bash scripts/smoke.sh plus targeted OmO verify scripts in CI/local acceptance.",
        "status": "done",
        "dependencies": [
          "96"
        ],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "Extend smoke.sh with OmO policy assertions",
            "description": "Add checks for profile isolation, disabled loop-heavy defaults, and Taskmaster-only task authority.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 2,
            "title": "Add targeted OmO verification script",
            "description": "Implement scripts/opencode/verify-omo.sh for focused config/state checks usable locally and in CI.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 3,
            "title": "Wire relevant crate/shell checks by touched scope",
            "description": "Ensure validation commands include bash syntax checks and relevant cargo check/test where integration touches Rust crates.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 4,
            "title": "Document manual acceptance regression steps",
            "description": "Capture final operator verification checklist including rollback rehearsal and profile switch validation.",
            "status": "pending",
            "dependencies": []
          }
        ],
        "aocPrd": {
          "path": ".taskmaster/docs/prds/omo-integration_prd_rpg.md",
          "updatedAt": "2026-02-22T15:30:24.315Z",
          "version": 1
        },
        "updatedAt": "2026-02-23T08:09:30.523Z",
        "activeAgent": false
      },
      {
        "id": "98",
        "title": "Publish OmO integration runbook and operator docs",
        "description": "Document sandbox usage, profile promotion/rollback, task governance, and one-command setup expectations.",
        "details": "Update installation/agents docs and add dedicated OmO integration guide with troubleshooting and recovery steps.",
        "testStrategy": "Perform a doc-driven dry run on clean profile/project and confirm every documented step reproduces expected behavior.",
        "status": "done",
        "dependencies": [
          "96"
        ],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "Update installation docs for sandbox-first OmO",
            "description": "Document end-to-end install flow including profile isolation defaults and one-command setup expectations.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 2,
            "title": "Update governance docs for Taskmaster and context authority",
            "description": "Clarify that OmO is additive while Taskmaster and .aoc memory remain canonical sources of truth.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 3,
            "title": "Add dedicated OmO integration runbook",
            "description": "Create scenario-based guide for sandbox usage, promotion, rollback, and troubleshooting.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 4,
            "title": "Add migration and rollback quick reference",
            "description": "Provide concise command snippets for switching profiles, recovering configs, and disabling OmO safely.",
            "status": "pending",
            "dependencies": []
          }
        ],
        "aocPrd": {
          "path": ".taskmaster/docs/prds/omo-integration_prd_rpg.md",
          "updatedAt": "2026-02-22T15:30:24.342Z",
          "version": 1
        },
        "updatedAt": "2026-02-22T15:30:24.342Z",
        "activeAgent": false
      },
      {
        "id": "99",
        "title": "Validate production-ready one-command OmO setup",
        "description": "Prove that ./install.sh plus aoc-init consistently yields optimized OmO-enabled AOC behavior from clean environments.",
        "details": "Execute final acceptance checklist, capture evidence, and record durable architecture decisions in aoc-mem before declaring rollout complete.",
        "testStrategy": "Run full clean-environment rehearsal, verify policy invariants and manual workflows, and archive final acceptance notes.",
        "status": "done",
        "dependencies": [
          "97",
          "98"
        ],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "Run clean-environment install/init rehearsal",
            "description": "Validate from fresh profile that ./install.sh and aoc-init produce expected OmO-enabled AOC state.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 2,
            "title": "Run governance acceptance workflow",
            "description": "Execute sample tasks to confirm Taskmaster authority, context-pack behavior, and absence of forbidden loop defaults.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 3,
            "title": "Capture performance and control metrics",
            "description": "Record token/control observations against baseline to confirm integration remains engineer-controlled.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 4,
            "title": "Publish final sign-off and durable decisions",
            "description": "Record rollout decision in aoc-mem and finalize implementation handoff notes.",
            "status": "pending",
            "dependencies": []
          }
        ],
        "aocPrd": {
          "path": ".taskmaster/docs/prds/omo-integration_prd_rpg.md",
          "updatedAt": "2026-02-22T15:30:24.355Z",
          "version": 1
        },
        "updatedAt": "2026-02-22T15:30:24.355Z",
        "activeAgent": false
      },
      {
        "id": "100",
        "title": "Add selectable OmO agent mode in control panel",
        "description": "Expose OmO as a first-class selectable agent while preserving standalone OpenCode behavior.",
        "details": "Add a new 'omo' agent path in aoc-agent/aoc-agent-run/aoc-control, introduce aoc-omo launcher that resolves sandbox profile via aoc-opencode-profile and sets OPENCODE_CONFIG_DIR process-locally, and keep existing 'oc' path unchanged for native OpenCode usage.",
        "testStrategy": "Verify selecting default agent=omo launches with sandbox OPENCODE_CONFIG_DIR, selecting default agent=oc launches without forced profile override, and smoke/regression tests assert no cross-profile conflict.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-23T08:38:14.335Z",
        "activeAgent": false
      }
    ]
  },
  "mission-control": {
    "tasks": [
      {
        "id": "43",
        "title": "Define Mission Control architecture and event schema (Rust)",
        "description": "Document the Rust-native Mission Control ecosystem, session scoping, and data flows.",
        "details": "Deliverables: update docs/mission-control.md for Rust components (aoc-hub-rs, aoc-agent-wrap-rs, aoc-taskmaster Ratatui TUI, aoc-mission-control Ratatui TUI); keep envelope fields, message types, env vars, limits; add Rust runtime/logging notes and concurrency/backpressure guidance; note existing Go docs/impl as reference for the port.\n\nProgress: Updated docs/mission-control.md for Rust-only stack; removed Go references and added Rust implementation/backpressure notes.",
        "testStrategy": "Review doc for Rust component naming and schema completeness; validate JSON examples; confirm session_id derivation and local-only socket guidance.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-28T20:13:44.839Z",
        "activeAgent": false
      },
      {
        "id": "44",
        "title": "Implement session-scoped status hub (Rust)",
        "description": "Build a Rust WebSocket hub that aggregates agent updates and serves Mission Control and Taskmaster clients within a session.",
        "details": "Deliverables: Rust aoc-hub-rs using tokio plus axum or warp and tungstenite; listen on AOC_HUB_ADDR default 127.0.0.1:PORT_FROM_SESSION_ID; hello handshake and session_id validation; per-agent state cache and snapshot; ping/heartbeat with stale reaper; strict envelope/payload validation and size limits; structured tracing logs; reuse Go hub behavior as reference while porting.\n\nProgress: Created crates/aoc-hub-rs with axum WebSocket server, hello handshake, envelope validation, state cache + snapshot broadcast, ping + stale reaper, and tracing logs. Builds with cargo check.",
        "testStrategy": "Start hub, connect publisher/subscriber, verify broadcast and snapshot; reject wrong session_id; restart hub and confirm reconnect plus state replay.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-29T15:11:21+00:00",
        "activeAgent": false
      },
      {
        "id": "45",
        "title": "Implement agent-agnostic Rust wrapper for status streaming",
        "description": "Create a Rust wrapper that launches any agent process and streams status, diff, and tasks to the hub.",
        "details": "Deliverables: Rust aoc-agent-wrap-rs using tokio; spawn child command with stdio attached; resolve session_id/pane_id/agent_id/project_root; connect to hub with backoff; fs notify tasks/state with debounce; compute diff_summary via git commands; handle non-git or missing git; serve diff_patch responses; emit heartbeat and offline on exit; structured tracing logs; parity with existing Go wrapper as reference.\n\nProgress: Created crates/aoc-agent-wrap-rs baseline to spawn child, send hello/agent_status/heartbeat, reconnect to hub, and return diff_patch_request as not_implemented. Compiles with cargo check.",
        "testStrategy": "Wrap dummy command; verify hub sees status and heartbeats; edit file to trigger diff update; stop hub to verify reconnect and state resend.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-29T15:11:21+00:00",
        "activeAgent": false
      },
      {
        "id": "46",
        "title": "Port Taskmaster to native Rust Ratatui app",
        "description": "Replace the Zellij Taskmaster plugin with a Rust Ratatui TUI that edits Taskmaster JSON directly.",
        "details": "Deliverables: Rust aoc-taskmaster using ratatui and crossterm; resolve project_root from cwd or AOC_PROJECT_ROOT; parse .taskmaster tasks/state JSON with numeric or string IDs; list and details panes with subtasks, active-agent marker, help view; keybindings j/k, Up/Down, Enter, Space, Tab, x, f, t, r, ?; filter and tag cycling; atomic writes with temp file rename and update state.json; clear error view with retry; optional task_summary publish to hub.",
        "testStrategy": "Toggle task status and active_agent and verify tasks.json updates; cycle tags and filters and confirm list updates; corrupt tasks.json and verify error view instead of crash.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-28T20:33:48.762Z",
        "activeAgent": false
      },
      {
        "id": "47",
        "title": "Build Mission Control Ratatui UI (agent list + diff views)",
        "description": "Implement Mission Control in Rust with agent list, diff list, and patch view.",
        "details": "Deliverables: Rust aoc-mission-control using ratatui and crossterm; websocket subscriber to hub; maintain per-agent state; left column agent list and status summary, right column diff file list and patch view; request diff_patch on demand; cache patches and invalidate when diff_summary changes; keybindings for navigation, focus switching, search, refresh; empty/error states.\n\nProgress: Created crates/aoc-mission-control skeleton with Ratatui TUI, websocket subscriber + hello, agent list, and details panel showing status/diff summary basics. Compiles with cargo check.",
        "testStrategy": "Feed mock hub events for multiple agents and verify UI updates; select file and confirm patch view loads and scrolls; verify empty and error states render without panic.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-29T16:04:05+00:00",
        "activeAgent": false
      },
      {
        "id": "48",
        "title": "Integrate editor workflow inside Mission Control (Rust)",
        "description": "Allow editing selected diff files from Mission Control using the default editor.",
        "details": "Deliverables: add editor action that exits raw mode and alternate screen, runs editor subprocess, then restores TUI; choose editor from AOC_EDITOR or EDITOR with fallback to micro; optional line jump when hunk info exists; refresh diff_summary on return; handle missing file paths with visible error message.",
        "testStrategy": "Open file, edit, exit, confirm diff list updates; unset EDITOR and confirm fallback editor used; attempt to open missing file and verify graceful error.",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-28T18:45:27.895Z",
        "activeAgent": false
      },
      {
        "id": "49",
        "title": "Wire Zellij layout and keybinding for Mission Control and Rust Taskmaster",
        "description": "Update Zellij layouts and launch scripts to start the Rust hub, Rust Taskmaster, and Mission Control.",
        "details": "Implementation status (2026-02-06):\n- Replaced default layout right-top panes with single AOC Pulse pane in both base and swap layouts; kept bottom-right terminal pane.\n- Added deterministic hub env injection and startup checks in aoc-launch/aoc-new-tab.\n- Updated aoc-agent-wrap to export required env (AOC_SESSION_ID, AOC_PANE_ID, AOC_PROJECT_ROOT, AOC_HUB_ADDR, AOC_HUB_URL) and route through aoc-agent-wrap-rs by default.\n- Implemented AOC Pulse runtime in crates/aoc-mission-control with 4 modes (Overview/Work/Diff/Health), hub-preferred v2, and local fallback v1 without hub or agent-thought parsing.\n- Normalized telemetry identity to session_id::pane_id in aoc-agent-wrap-rs; labels are metadata.\n- Updated hub state cache to retain task_summary snapshots per tag per agent identity key.\n\nValidation evidence:\n- cargo check --manifest-path crates/Cargo.toml (pass)\n- cargo check --manifest-path crates/Cargo.toml -p aoc-mission-control -p aoc-agent-wrap-rs -p aoc-hub-rs (pass)\n- bash -n bin/aoc-launch bin/aoc-new-tab bin/aoc-agent-wrap (pass)\n- Layout verification: zellij/layouts/aoc.kdl.template no longer references Clock/Widget/ClockTemp and now launches AOC Pulse.\n- Hub mode smoke: launched aoc-hub-rs + two aoc-agent-wrap-rs publishers with same label and pane_ids 101/102; hub log shows distinct identities smoke-hub-...::101 and ::102.\n- Fallback smoke: launched aoc-agent-wrap-rs with unreachable hub; runtime snapshot written under ~/.local/state/aoc/telemetry/<session>/<pane>.json with agent_id=<session>::<pane>.\n- Pulse run smoke: aoc-mission-control started under pseudo-tty with no hub (connect warnings + continued run) and with hub available (continued run without connect warnings).\n\nRemaining manual UX confirmation:\n- Visual confirmation in a real interactive Zellij desktop session that top-right default pane renders AOC Pulse and updates live while hub is up/down.",
        "testStrategy": "Validation matrix:\n1) Single session, multiple tabs/panes with mixed agents: Pulse Overview must list unique pane identities with no overwrites.\n2) Two concurrent Zellij sessions: no cross-session leakage (different derived hub addr and isolated state).\n3) Hub present: Pulse consumes hub snapshots/events and updates heartbeat, task, and diff summaries live.\n4) Hub absent: Pulse falls back to v1 introspection with useful Overview/Work/Diff/Health data.\n5) Layout migration: right-column top area shows only AOC Pulse (Widget+Clock removed) and bottom terminal remains usable.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Replace Widget+Clock with AOC Pulse pane",
            "description": "Update zellij/layouts/aoc.kdl.template (and swap layout) to use one top-right AOC Pulse pane and retain bottom-right terminal pane.",
            "status": "done",
            "dependencies": []
          },
          {
            "id": 2,
            "title": "Implement Pulse v1 introspection data source",
            "description": "Build headless-safe Overview/Work/Diff/Health from zellij metadata + git + Taskmaster files, without parsing agent internals.",
            "status": "done",
            "dependencies": []
          },
          {
            "id": 3,
            "title": "Wire hub and wrapper telemetry as default runtime path",
            "description": "Start one hub per session and ensure wrapped agents publish agent_status/heartbeat/diff_summary/task_summary via aoc-agent-wrap-rs or equivalent.",
            "status": "done",
            "dependencies": []
          },
          {
            "id": 4,
            "title": "Normalize identity to session+pane and add fallback logic",
            "description": "Use unique per-pane identity to avoid cross-tab collisions; prefer hub data and degrade to v1 introspection when unavailable.",
            "status": "done",
            "dependencies": []
          }
        ],
        "aocPrd": null,
        "updatedAt": "2026-02-06T10:28:20.668Z",
        "activeAgent": false
      },
      {
        "id": "50",
        "title": "Deprecate Zellij Taskmaster plugin and update docs/install for Rust CLI",
        "description": "Remove the Zellij plugin from default flows and document the Rust-native Taskmaster CLI.",
        "details": "Deliverables: mark plugin as legacy in README/docs; update install.sh to build and install Rust binaries (hub, wrapper, taskmaster, mission-control); keep optional plugin build flag; update scripts/build-taskmaster-plugin.sh and add migration notes.",
        "testStrategy": "Run clean install and confirm aoc-taskmaster launches; enable legacy flag and verify plugin can still be built.",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-28T18:45:50.911Z",
        "activeAgent": false
      },
      {
        "id": "51",
        "title": "Add observability and multi-session isolation test plan (Rust)",
        "description": "Add logs, reconnection, and isolation checks for Rust hub, wrapper, Mission Control, and Taskmaster.",
        "details": "Deliverables: standardize logs under .aoc/logs with session_id prefixes; use tracing and tracing-subscriber; honor AOC_LOG_LEVEL and AOC_LOG_DIR and map to RUST_LOG; log connect and reconnect events, schema errors, backpressure drops; add manual isolation checklist and reconnection test docs.",
        "testStrategy": "Start two sessions and confirm no cross-session messages; kill hub and verify clients reconnect with logs showing state transitions.",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-28T18:45:50.919Z",
        "activeAgent": false
      },
      {
        "id": "52",
        "title": "Add Session Manager to Mission Control (projects + defaults)",
        "description": "Extend the Rust Mission Control UI with a Session Manager that can switch projects, create new projects, and set defaults.",
        "details": "Deliverables: Ratatui Session Manager view with Projects, New Project, and Defaults sections; list directories from AOC_PROJECTS_BASE (default ~/dev), provide search and open a new AOC tab via zellij action new-tab --layout <layout> --cwd <path>; New Project prompts for name, creates directory, runs aoc-init, then opens new tab; Defaults set layout, agent, editor and persist to config (for example ~/.config/aoc/config.toml) used by aoc-launch and aoc-new-tab; keybindings Tab, Enter, n, /, Esc; support AOC_CONFIG_PATH and AOC_PROJECTS_BASE overrides; display errors when mkdir or aoc-init fails.",
        "testStrategy": "Open Mission Control and verify Projects list from ~/dev; search and open project to create new tab; create new project and confirm aoc-init runs; change defaults and confirm persisted config is applied to new tabs; verify error handling when projects base is missing or aoc-init fails.",
        "status": "done",
        "dependencies": [
          "47",
          "49"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-30T16:55:48.425Z",
        "activeAgent": false
      },
      {
        "id": "53",
        "title": "Plan active tag selector UI for Rust Taskmaster",
        "description": "",
        "details": "",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-30T08:50:34.724Z",
        "activeAgent": false
      },
      {
        "id": "55",
        "title": "Revise aoc-control TUI to yazi-style hjkl navigation and clearer menu UX",
        "description": "",
        "details": "",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-01T16:59:30.404Z",
        "activeAgent": true
      },
      {
        "id": "70",
        "title": "Overview: attention chip and compact actionable context",
        "description": "Make overview rows operator-first by replacing source-first emphasis with attention status and always showing compact context.",
        "details": "Introduce deterministic attention chip (ERR/NEEDS/BLOCK/STALE/OK), keep lifecycle+tab, and ensure compact mode reserves space for M: context instead of dropping it.",
        "testStrategy": "Unit tests for attention precedence and row text under narrow widths.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-08T21:55:50.464Z",
        "activeAgent": false
      },
      {
        "id": "71",
        "title": "Overview: task/git mini-signals in row presenter",
        "description": "Surface lightweight work pressure signals without extra polling.",
        "details": "Derive W:x/y from hub task summaries and G:+/-/? from diff summaries; show only when available and width allows.",
        "testStrategy": "Presenter tests for signal visibility and fallback behavior.",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-08T21:55:50.475Z",
        "activeAgent": false
      },
      {
        "id": "72",
        "title": "Overview: attention-priority sort mode with toggle",
        "description": "Support urgency-first triage while preserving tab-order mode.",
        "details": "Add App sort mode enum, key toggle, and severity-first sorting path with stable tie-breakers for layout order.",
        "testStrategy": "Unit tests verifying severity sort and layout sort invariants.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-08T21:55:50.497Z",
        "activeAgent": false
      },
      {
        "id": "73",
        "title": "Overview: debug source toggle and keybind help updates",
        "description": "Keep HUB/LOC/MIX provenance available without cluttering default operator view.",
        "details": "Add toggle to swap attention chip with source chip plus footer/help text updates for new overview controls.",
        "testStrategy": "Widget rendering tests and key handling tests for toggle behavior.",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-08T21:55:50.512Z",
        "activeAgent": false
      },
      {
        "id": "74",
        "title": "Phase 2: re-enable Pulse Overview after value criteria",
        "description": "Revisit overview mode only after realtime fidelity and operator-value criteria are met.",
        "details": "Use AOC_PULSE_OVERVIEW_ENABLED as rollout gate. Re-enable by default only when status transitions are realtime, rows provide actionable context, and triage speed improves in practice.",
        "testStrategy": "Run a bake with overview enabled, compare latency/noise and operator triage outcomes against Work/Diff/Health baseline.",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-09T07:28:50.304Z",
        "activeAgent": false
      }
    ]
  },
  "deprecation": {
    "tasks": [
      {
        "id": "111",
        "title": "Define supported agent matrix and deprecation policy",
        "description": "Identify which agents remain first-class, which are deprecated, and establish an execution order for removals starting with OMO.",
        "details": "",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-23T17:51:15.879Z",
        "activeAgent": false
      },
      {
        "id": "112",
        "title": "Deprecate OMO from agent selection surfaces",
        "description": "Remove OMO from aoc-agent, aoc-agent-run, and control-panel options while preserving OC behavior.",
        "details": "",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-23T17:51:15.902Z",
        "activeAgent": false
      },
      {
        "id": "113",
        "title": "Remove OMO runtime wrappers and profile manager",
        "description": "Plan deletion of aoc-omo and aoc-opencode-profile and remove shared-script branches gated by AOC_OMO settings.",
        "details": "",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-23T17:51:15.915Z",
        "activeAgent": false
      },
      {
        "id": "114",
        "title": "Stop implicit OMO seeding in install and init",
        "description": "Ensure install.sh and aoc-init no longer seed OMO policies or profile scaffolding by default.",
        "details": "",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-24T03:50:43.933Z",
        "activeAgent": false
      },
      {
        "id": "115",
        "title": "Delete OMO policy templates and OMO scripts",
        "description": "Retire config/opencode/oh-my-opencode policy files and scripts/opencode install/verify OMO workflows with tests.",
        "details": "",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-23T17:51:15.959Z",
        "activeAgent": false
      },
      {
        "id": "116",
        "title": "Prune OMO smoke and CI regression checks",
        "description": "Remove OMO-specific checks from smoke and CI while preserving core AOC validation coverage.",
        "details": "",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-23T17:51:15.978Z",
        "activeAgent": false
      },
      {
        "id": "117",
        "title": "Update docs for OMO deprecation and agent support",
        "description": "Remove OMO references from user docs and publish the supported agent list plus migration notes.",
        "details": "",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-23T17:51:15.998Z",
        "activeAgent": false
      },
      {
        "id": "118",
        "title": "Audit non-OMO agent usage for future removals",
        "description": "Assess usage of remaining agents to identify additional deprecation candidates beyond OMO.",
        "details": "",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-23T17:51:16.012Z",
        "activeAgent": false
      },
      {
        "id": "119",
        "title": "Close or reclassify existing OMO task backlog",
        "description": "Review tag omo tasks and convert pending work into deprecation outcomes or archival status.",
        "details": "",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-23T17:51:16.029Z",
        "activeAgent": false
      },
      {
        "id": "120",
        "title": "Create local cleanup playbook for OMO artifacts",
        "description": "Document and script optional cleanup of local OMO binaries, profiles, and policy files.",
        "details": "",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "low",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-23T17:51:16.052Z",
        "activeAgent": false
      }
    ]
  },
  "master": {
    "tasks": [
      {
        "id": "1",
        "title": "Add aoc-doctor dependency checker",
        "description": "Create a script that validates required tools (zellij, yazi, fzf, chafa, ffmpeg, poppler-utils, librsvg2-bin, rg, bat, tectonic) and prints actionable install hints.",
        "details": "Add bin/aoc-doctor and document in README.md; include exit codes and a --quiet mode for CI.",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "Define dependency list and install hints",
            "description": "Classify required vs optional tools and map each to distro-specific install hints for README and aoc-doctor output.",
            "status": "pending",
            "dependencies": [],
            "priority": "",
            "details": "",
            "testStrategy": "",
            "activeAgent": false,
            "subtasks": null
          },
          {
            "id": 2,
            "title": "Implement bin/aoc-doctor with exit codes",
            "description": "Create aoc-doctor that checks PATH/tools, supports --quiet, and returns non-zero on missing required deps.",
            "status": "pending",
            "dependencies": [],
            "subtasks": null,
            "priority": "",
            "testStrategy": "",
            "details": "",
            "activeAgent": false
          },
          {
            "id": 3,
            "title": "Document doctor usage",
            "description": "Add README section with example output and suggested install fixes.",
            "status": "pending",
            "dependencies": [],
            "priority": "",
            "details": "",
            "testStrategy": "",
            "activeAgent": false,
            "subtasks": null
          }
        ],
        "aocPrd": null,
        "updatedAt": "2026-01-27T16:47:45.724Z",
        "activeAgent": false
      },
      {
        "id": "2",
        "title": "Improve aoc-taskmaster interactivity",
        "description": "Enhance the Taskmaster pane UX with actions to mark done, open details, and refresh lists.",
        "details": "Add key bindings in bin/aoc-taskmaster (e.g., enter to open, d to mark done, r to refresh) and handle missing task-master-ai gracefully.",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "Detect missing task-master-ai",
            "description": "Add graceful fallback when TM binary is missing (message + exit or read-only mode).",
            "status": "pending",
            "dependencies": [],
            "activeAgent": false,
            "subtasks": null,
            "testStrategy": "",
            "priority": "",
            "details": ""
          },
          {
            "id": 2,
            "title": "Add task actions in UI",
            "description": "Implement keybinds to mark done/reopen, open task details, and refresh without restarting.",
            "status": "pending",
            "dependencies": [],
            "testStrategy": "",
            "details": "",
            "priority": "",
            "activeAgent": false,
            "subtasks": null
          },
          {
            "id": 3,
            "title": "Update help text and keybinds",
            "description": "Keep the on-screen hints aligned with the new actions and modes.",
            "status": "pending",
            "dependencies": [],
            "details": "",
            "testStrategy": "",
            "priority": "",
            "activeAgent": false,
            "subtasks": null
          }
        ],
        "aocPrd": null,
        "updatedAt": "2026-01-27T16:47:45.730Z",
        "activeAgent": false
      },
      {
        "id": "3",
        "title": "Widget resilience and UX polish",
        "description": "Improve aoc-widget to handle missing tools and invalid media paths with clear prompts.",
        "details": "Add detection for chafa/ffmpeg/rsvg-convert and show fallback text; persist last mode in state file.",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "Persist widget mode",
            "description": "Store last mode (cal/media) in state file and restore on start.",
            "status": "pending",
            "dependencies": [],
            "subtasks": null,
            "testStrategy": "",
            "priority": "",
            "activeAgent": false,
            "details": ""
          },
          {
            "id": 2,
            "title": "Add tool checks and fallbacks",
            "description": "Detect chafa/ffmpeg/rsvg-convert and show clear fallback instructions.",
            "status": "pending",
            "dependencies": [],
            "priority": "",
            "subtasks": null,
            "activeAgent": false,
            "testStrategy": "",
            "details": ""
          },
          {
            "id": 3,
            "title": "Improve path selection flow",
            "description": "Add validation and non-blocking prompt when media path is missing or unsupported.",
            "status": "pending",
            "dependencies": [],
            "testStrategy": "",
            "activeAgent": false,
            "priority": "",
            "details": "",
            "subtasks": null
          }
        ],
        "aocPrd": null,
        "updatedAt": "2026-01-27T16:47:45.751Z",
        "activeAgent": false
      },
      {
        "id": "4",
        "title": "Sys details configurability",
        "description": "Allow aoc-sys to be configured for update interval and sections.",
        "details": "Support env vars like AOC_SYS_INTERVAL and toggles for CPU/mem/disk output.",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "Add env var support",
            "description": "Implement AOC_SYS_INTERVAL and section toggles (CPU/Mem/Disk) with defaults.",
            "status": "pending",
            "dependencies": [],
            "subtasks": null,
            "testStrategy": "",
            "details": "",
            "activeAgent": false,
            "priority": ""
          },
          {
            "id": 2,
            "title": "Update sys output formatting",
            "description": "Keep output stable for small panes; handle missing /proc gracefully.",
            "status": "pending",
            "dependencies": [],
            "priority": "",
            "activeAgent": false,
            "details": "",
            "testStrategy": "",
            "subtasks": null
          },
          {
            "id": 3,
            "title": "Document aoc-sys configuration",
            "description": "Add README section with env vars and examples.",
            "status": "pending",
            "dependencies": [],
            "priority": "",
            "testStrategy": "",
            "activeAgent": false,
            "subtasks": null,
            "details": ""
          }
        ],
        "aocPrd": null,
        "updatedAt": "2026-01-27T16:47:45.760Z",
        "activeAgent": false
      },
      {
        "id": "5",
        "title": "Layout customization options",
        "description": "Allow users to override pane sizes and commands without editing aoc.kdl directly.",
        "details": "Document environment variables or alternate layout file strategy in README.md; consider templating in install.sh.",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "Choose customization strategy",
            "description": "Decide between env var overrides or templated layout copy on install.",
            "status": "done",
            "dependencies": [],
            "activeAgent": false,
            "priority": "",
            "testStrategy": "",
            "subtasks": null,
            "details": ""
          },
          {
            "id": 2,
            "title": "Implement override mechanism",
            "description": "Add layout templating or alternate layout file resolution in install/launch.",
            "status": "done",
            "dependencies": [],
            "testStrategy": "",
            "activeAgent": false,
            "priority": "",
            "subtasks": null,
            "details": ""
          },
          {
            "id": 3,
            "title": "Document layout overrides",
            "description": "Provide examples for custom sizes/commands in README.",
            "status": "done",
            "dependencies": [],
            "details": "",
            "activeAgent": false,
            "subtasks": null,
            "priority": "",
            "testStrategy": ""
          }
        ],
        "aocPrd": null,
        "updatedAt": "2026-01-06T17:03:07.336Z",
        "activeAgent": false
      },
      {
        "id": "6",
        "title": "Installer improvements and uninstall path",
        "description": "Add an uninstall script and make install.sh idempotent with clear output.",
        "details": "Add bin/aoc-uninstall or scripts/uninstall.sh; ensure it removes only files installed by AOC.",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "Add uninstall script",
            "description": "Create aoc-uninstall or scripts/uninstall.sh to remove installed files only.",
            "status": "pending",
            "dependencies": [],
            "testStrategy": "",
            "priority": "",
            "subtasks": null,
            "details": "",
            "activeAgent": false
          },
          {
            "id": 2,
            "title": "Make installer idempotent",
            "description": "Ensure install.sh overwrites safely, prints what changed, and exits cleanly on re-run.",
            "status": "pending",
            "dependencies": [],
            "testStrategy": "",
            "subtasks": null,
            "priority": "",
            "details": "",
            "activeAgent": false
          },
          {
            "id": 3,
            "title": "Document install/uninstall",
            "description": "Add README usage examples and expected file paths.",
            "status": "pending",
            "dependencies": [],
            "subtasks": null,
            "priority": "",
            "testStrategy": "",
            "details": "",
            "activeAgent": false
          }
        ],
        "aocPrd": null,
        "updatedAt": "2026-01-06T17:03:08.164Z",
        "activeAgent": false
      },
      {
        "id": "7",
        "title": "README enhancements and troubleshooting",
        "description": "Add setup verification, troubleshooting, and screenshot usage guidance.",
        "details": "Include common failures (missing chafa, yazi preview) and how to fix; add placeholder for screenshot.",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "Add setup verification checklist",
            "description": "Document a quick checklist (zellij version, yazi preview, widget media) and how to confirm.",
            "status": "pending",
            "dependencies": [],
            "activeAgent": false,
            "priority": "",
            "testStrategy": "",
            "subtasks": null,
            "details": ""
          },
          {
            "id": 2,
            "title": "Add troubleshooting section",
            "description": "Cover common errors (missing tools, blank preview, taskmaster missing) with fixes.",
            "status": "pending",
            "dependencies": [],
            "activeAgent": false,
            "subtasks": null,
            "testStrategy": "",
            "priority": "",
            "details": ""
          },
          {
            "id": 3,
            "title": "Add screenshot guidance",
            "description": "Include placeholder path and note for updating the screenshot in README.",
            "status": "pending",
            "dependencies": [],
            "activeAgent": false,
            "details": "",
            "testStrategy": "",
            "priority": "",
            "subtasks": null
          }
        ],
        "aocPrd": null,
        "updatedAt": "2026-01-06T17:03:09.086Z",
        "activeAgent": false
      },
      {
        "id": "8",
        "title": "Add shellcheck lint workflow",
        "description": "Introduce a lightweight CI or local script to run shellcheck on bin/ and yazi/preview.sh.",
        "details": "Add scripts/lint.sh or a GitHub Actions workflow; document in README.md.",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "Create scripts/lint.sh",
            "description": "Add shellcheck invocation over bin/ and yazi/preview.sh with sensible flags.",
            "status": "pending",
            "dependencies": [],
            "subtasks": null,
            "testStrategy": "",
            "priority": "",
            "details": "",
            "activeAgent": false
          },
          {
            "id": 2,
            "title": "Add GitHub Actions lint workflow",
            "description": "Optional CI workflow that runs shellcheck on pushes/PRs.",
            "status": "pending",
            "dependencies": [],
            "activeAgent": false,
            "testStrategy": "",
            "priority": "",
            "subtasks": null,
            "details": ""
          },
          {
            "id": 3,
            "title": "Document lint usage",
            "description": "Add README instructions for running lint locally and in CI.",
            "status": "pending",
            "dependencies": [],
            "priority": "",
            "activeAgent": false,
            "subtasks": null,
            "testStrategy": "",
            "details": ""
          }
        ],
        "aocPrd": null,
        "updatedAt": "2026-01-06T17:03:10.110Z",
        "activeAgent": false
      },
      {
        "id": "9",
        "title": "Versioning and release notes",
        "description": "Define a minimal versioning scheme and CHANGELOG.md.",
        "details": "Add CHANGELOG.md and update README.md with release process; optional tag naming.",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "Create CHANGELOG.md",
            "description": "Add initial release section describing current features.",
            "status": "pending",
            "dependencies": [],
            "priority": "",
            "activeAgent": false,
            "subtasks": null,
            "details": "",
            "testStrategy": ""
          },
          {
            "id": 2,
            "title": "Define versioning scheme",
            "description": "Document SemVer (or similar) and tag naming in README.",
            "status": "pending",
            "dependencies": [],
            "details": "",
            "activeAgent": false,
            "testStrategy": "",
            "priority": "",
            "subtasks": null
          },
          {
            "id": 3,
            "title": "Add release checklist",
            "description": "Add a small checklist for cutting releases and tagging.",
            "status": "pending",
            "dependencies": [],
            "testStrategy": "",
            "priority": "",
            "activeAgent": false,
            "details": "",
            "subtasks": null
          }
        ],
        "aocPrd": null,
        "updatedAt": "2026-01-06T17:03:11.326Z",
        "activeAgent": false
      },
      {
        "id": "10",
        "title": "Zellij Taskmaster plugin (realtime tasks panel)",
        "description": "Design and implement a Zellij plugin that renders Task Master tasks in realtime from .taskmaster/tasks/tasks.json and wires CLI actions (task-master) for updates.",
        "details": "",
        "testStrategy": "Manual: launch zellij layout with plugin pane; verify realtime updates on tasks.json changes and basic actions (filter, show details, set status).",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Collect Task Master schema + CLI usage for renderer/actions",
            "description": "Summarize tasks.json schema and relevant CLI commands (list/show/set-status/update/add/remove) to support plugin rendering and actions.",
            "status": "done",
            "dependencies": [],
            "activeAgent": false,
            "testStrategy": "",
            "details": "",
            "priority": "",
            "subtasks": null
          },
          {
            "id": 2,
            "title": "Evaluate Zellij plugin API + integration points",
            "description": "Confirm zellij-tile capabilities (events, workers, filesystem access) and how to ship/load plugin in this repo.",
            "status": "done",
            "dependencies": [],
            "priority": "",
            "activeAgent": false,
            "testStrategy": "",
            "details": "",
            "subtasks": null
          },
          {
            "id": 3,
            "title": "Design plugin UX + state model",
            "description": "Define list/detail views, filters, keybindings, realtime refresh strategy, and error states (missing tasks.json, parse errors).",
            "status": "done",
            "dependencies": [],
            "details": "",
            "subtasks": null,
            "activeAgent": false,
            "testStrategy": "",
            "priority": ""
          },
          {
            "id": 4,
            "title": "Scaffold plugin project + build pipeline",
            "description": "Add plugin source (Rust/WASM), build scripts, and install integration for zellij config/layout.",
            "status": "done",
            "dependencies": [],
            "activeAgent": false,
            "priority": "",
            "subtasks": null,
            "details": "",
            "testStrategy": ""
          },
          {
            "id": 5,
            "title": "Implement realtime renderer + file watcher/polling",
            "description": "Load tasks.json, parse tasks/subtasks, render list/detail, and refresh on interval or file mtime change.",
            "status": "done",
            "dependencies": [],
            "details": "",
            "testStrategy": "",
            "priority": "",
            "activeAgent": false,
            "subtasks": null
          },
          {
            "id": 6,
            "title": "Wire CLI actions (status changes, open details)",
            "description": "Integrate task-master CLI commands for status changes and task updates; handle errors gracefully.",
            "status": "done",
            "dependencies": [],
            "subtasks": null,
            "activeAgent": false,
            "priority": "",
            "testStrategy": "",
            "details": ""
          },
          {
            "id": 7,
            "title": "Update docs + install instructions",
            "description": "Document plugin build/install, configuration, and keybindings in README; update install/uninstall as needed.",
            "status": "done",
            "dependencies": [],
            "details": "",
            "priority": "",
            "subtasks": null,
            "testStrategy": "",
            "activeAgent": false
          }
        ],
        "aocPrd": null,
        "updatedAt": "2026-01-09T07:01:13.182Z",
        "activeAgent": false
      },
      {
        "id": "11",
        "title": "Refactor Taskmaster Plugin: Modularize Monolithic main.rs",
        "description": "Refactor the existing monolithic main.rs in the Taskmaster Zellij plugin into distinct modules (model, state, ui) to improve maintainability and separation of concerns.",
        "details": "The current implementation of the Taskmaster plugin resides almost entirely in `plugins/taskmaster/src/main.rs`. To improve code organization and testability, the code should be split into logical modules.\n\n### Proposed Structure:\n1. **`src/model.rs`**: Move data structures here, specifically the `Task`, `TaskStatus`, and any serialization/deserialization logic (Serde structs).\n2. **`src/state.rs`**: encapsulate the application state logic. Move the `State` struct and its implementation (e.g., loading tasks from JSON, filtering logic, selection handling) here.\n3. **`src/ui.rs`**: Isolate rendering logic. Move the `render` function and any helper functions related to UI layout (e.g., calculating rows, drawing the header/footer) here.\n4. **`src/main.rs`**: Should become a thin entry point that initializes the `State`, handles the Zellij event loop (`update` method), and delegates rendering to `ui`.\n\n### Implementation Steps:\n- Create the new module files in `plugins/taskmaster/src/`.\n- Iteratively move code from `main.rs` to the respective modules, fixing visibility (`pub`) issues.\n- Ensure `Cargo.toml` dependencies (like `serde`, `zezellij-tile`) are accessible where needed.\n- Verify that the logic for loading `.taskmaster/tasks/tasks.json` remains intact in the `state` module.",
        "testStrategy": "1. **Compilation Check**: Ensure `cargo build --release --target wasm32-wasi` succeeds without errors.\n2. **Functional Verification**: Load the refactored plugin in Zellij. Verify that tasks still load correctly, navigation works (up/down), and filtering toggles work exactly as before.\n3. **Regression Test**: Confirm that no features from Task #10 (rendering, key updates) were lost during the refactor.",
        "status": "done",
        "dependencies": [
          "10"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-11T22:02:37.273Z",
        "activeAgent": false
      },
      {
        "id": "12",
        "title": "Implement UI Primitives: Table and ProgressBar for TUI",
        "description": "Create reusable `Table` and `ProgressBar` structs within the `ui` module of the Taskmaster plugin to standardize rendering of tabular data and progress indicators.",
        "details": "This task focuses on abstracting rendering logic into reusable components within `plugins/taskmaster/src/ui.rs` (or a sub-module like `ui/widgets.rs`). \n\n### Implementation Requirements:\n1. **ProgressBar Struct**:\n   - Fields: `progress` (f32 or usize), `total` (usize), `width` (usize), and styling characters (e.g., full block, empty block).\n   - Method `render(&self) -> String`: Returns a string representation of the bar (e.g., `[] 40%`).\n   - Should handle boundary conditions (0% and 100%).\n\n2. **Table Struct**:\n   - Design a struct that accepts headers and a list of rows.\n   - Support dynamic column width calculation based on content or fixed constraints.\n   - Method `render(&self) -> Vec<String>` or similar, yielding lines ready to be printed to the TUI buffer.\n   - Ensure alignment support (left/right/center) if feasible.\n\n3. **Integration**:\n   - Update the main rendering loop to use these new primitives instead of raw string formatting where applicable (e.g., displaying the task list as a table, showing completion status as a progress bar).\n   - Ensure these structs implement `Display` or specific render traits compatible with `zellij-tile`.\n\n### Codebase Alignment:\n- Place code in `src/ui.rs` if it exists (post-Task 11) or prepare it to be moved there.\n- Ensure compatibility with existing color definitions in the `State` or `Model`.",
        "testStrategy": "1. **Unit Tests**: Create unit tests in `src/ui.rs` for `ProgressBar` verifying output strings for 0%, 50%, and 100% progress. Test `Table` rendering with varying row lengths.\n2. **Visual Verification**: Temporarily modify the plugin's `render` method to display a static table and progress bar to verify alignment and visual style within Zellij.\n3. **Edge Cases**: Verify behavior when table content exceeds pane width (truncation vs wrapping).",
        "status": "done",
        "dependencies": [
          "10",
          "11"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-11T22:03:34.833Z",
        "activeAgent": false
      },
      {
        "id": "13",
        "title": "Implement Theme System (plugins/taskmaster): Add Nerd Fonts and Color Palette support",
        "description": "Introduce a centralized theme configuration to `plugins/taskmaster` providing semantic color palettes and Nerd Font icons for task statuses and UI elements.",
        "details": "This task focuses on decoupling hardcoded styles and icons from the rendering logic by introducing a `Theme` struct. This will improve consistency and allow for easier customization or future configuration.\n\n### Implementation Requirements:\n1. **Create `src/theme.rs`**:\n   - Define a `Theme` struct containing palette fields (e.g., `primary`, `success`, `warning`, `error`, `text_dim`) utilizing `zellij_tile::prelude::*` colors or ANSI codes.\n   - Define an `Icons` struct or fields within `Theme` for status icons (e.g., pending: `` / ``, active: `` / ``, done: `` / ``, blocked: `` / ``).\n   - Implement a default implementation for `Theme` that uses a standard color scheme (e.g., Catppuccin-inspired or system default) and Nerd Fonts if supported (consider a flag or default to yes).\n\n2. **Integrate Theme into State/UI**:\n   - Add `theme: Theme` to the plugin's `State` struct.\n   - Update `src/ui.rs` (or rendering logic in `main.rs` if not yet refactored) to use `state.theme` instead of hardcoded strings/colors.\n   - Replace manual `format!` calls having raw color codes with helper methods from the `Theme` (e.g., `theme.style_status(&task.status)`).\n\n3. **Iconography**:\n   - Ensure the chosen Nerd Font glyphs are standard and widely supported.\n   - Update the task list rendering to prefix tasks with their status icon.\n   - Update the status bar/footer to use icons for hints (e.g., `?` for help, `` for refresh).\n\n4. **Refactor Compatibility**:\n   - If Task 12 (UI Primitives) is complete, ensure `Table` and `ProgressBar` accept style definitions from the `Theme`.",
        "testStrategy": "1. **Visual Verification**: Launch the plugin in Zellij and verify that colors match the defined palette and icons render correctly (requires a Nerd Font patched terminal).\n2. **State Check**: Ensure the theme loads correctly on plugin start.\n3. **Regression Test**: Verify that text content remains readable and alignment is preserved with the addition of icons (which can sometimes be double-width).",
        "status": "done",
        "dependencies": [
          "11"
        ],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-11T22:05:07.218Z",
        "activeAgent": false
      },
      {
        "id": "14",
        "title": "Implement Dashboard Layout (plugins/taskmaster): Build Header HUD and Task Grid",
        "description": "Construct the main dashboard interface for the Taskmaster plugin by implementing a Header HUD for status summaries and a Task Grid for the main task list, utilizing the newly created UI primitives and theme system.",
        "details": "This task integrates the modular components created in previous tasks to build the final UI layout. The layout will be divided into two main sections: a Header HUD (Heads-Up Display) and a scrollable Task Grid.\n\n### Implementation Requirements:\n\n1. **Modify `src/ui.rs` (or `src/ui/layout.rs`)**:\n   - Implement a `draw_dashboard` function that accepts `&State`, `&Theme`, and `&mut UiWriter`.\n\n2. **Implement Header HUD**:\n   - **Layout**: Top section of the screen (fixed height, e.g., 3-4 rows).\n   - **Components**: \n     - **Progress Bar**: Use the `ProgressBar` struct (Task 12) to show overall completion (completed tasks / total tasks).\n     - **Stats**: Display counts for 'Pending', 'In Progress', 'Done' using theme colors (Task 13) (e.g., Green for Done, Yellow for In Progress).\n     - **Filter Status**: Show current active filter.\n\n3. **Implement Task Grid**:\n   - **Layout**: Remaining vertical space below the header.\n   - **Component**: Use the `Table` struct (Task 12) to render the list of tasks.\n   - **Columns**: ID, Status icon (Nerd Font from Task 13), Title, Priority, Age (calculated from timestamp).\n   - **Selection**: Highlight the currently selected row using the Theme's selection color.\n   - **Scrolling**: Ensure the table renders a window of tasks based on `state.selected_index` and available height.\n\n4. **Integration**:\n   - Update the main render loop in `main.rs` (or `lib.rs`) to call `draw_dashboard` instead of the legacy rendering logic.\n\n### Code Reference:\n- Utilize `zellij_tile::prelude::*` for coordinate management.\n- Access state properties from `State` struct (refactored in Task 11).",
        "testStrategy": "1. **Visual Layout Verification**: Run the plugin in Zellij and verify the screen is split into Header and Grid.\n2. **Data Consistency**: Check that the Header stats (e.g., '3/10 Done') match the actual rows in the Task Grid.\n3. **Selection & Scrolling**: Navigate up/down through the list; verify the highlight moves and the table scrolls when the selection goes off-screen.\n4. **Theme Verification**: Confirm that status icons and colors from Task 13 are correctly applied to the rows.",
        "status": "done",
        "dependencies": [
          "11",
          "12",
          "13"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-11T22:07:38.663Z",
        "activeAgent": false
      },
      {
        "id": "15",
        "title": "Implement Sub-task Rendering (plugins/taskmaster): Visualize nested subtasks in the details pane",
        "description": "Enhance the details pane in the Taskmaster plugin to recursively render subtasks with status indicators and progress bars.",
        "details": "This task involves updating the UI rendering logic to properly display nested subtasks when a user inspects a specific task. The `Task` model already contains a `subtasks` field (Vec<Task>), and this structure needs to be traversed and visualized.\n\n### Implementation Requirements:\n\n1.  **Modify `src/ui.rs` - `draw_details_pane`**:\n    - Locate the function responsible for drawing task details (likely stubbed or basic).\n    - Implement a recursive or iterative rendering strategy to display subtasks.\n    - **Indentation**: Visual hierarchy should be clear. Use spaces or tree branches (e.g., ``, ``) to denote depth.\n    - **Status Icons**: Use the `Theme` system to render status icons (e.g., checkmark for Done, spinner for In Progress) for each subtask.\n\n2.  **Progress Calculation**:\n    - Implement a helper method on `Task` (e.g., `calculate_progress() -> f32`) that recursively calculates completion percentage based on subtasks.\n    - Integrate the `ProgressBar` component (created in Task 12) into the details header or alongside complex subtask groups to show aggregate progress.\n\n3.  **Interaction Handling (if applicable)**:\n    - Ensure the scrolling logic in the details pane accommodates the potentially long list of subtasks.\n\n### Code Integration:\n- **Model**: Ensure `Task` struct in `src/model.rs` derives necessary traits (Clone, Debug) to be passed to the renderer easily.\n- **Theme**: Use `theme.icons.subtask_branch` (or similar) and colors defined in Task 13 for consistent styling.",
        "testStrategy": "1. **Data Mocking**: Create a `tasks.json` with deep nesting (e.g., Task -> Subtask A -> Subtask A.1).\n2. **Visual Verification**: Open the details pane for the nested task. Verify indentation is correct and tree structure is readable.\n3. **Progress Check**: Verify that the progress bar correctly reflects the ratio of completed subtasks.\n4. **Theme Check**: Ensure icons and colors for subtasks match the configured theme.",
        "status": "done",
        "dependencies": [
          "12",
          "13",
          "14"
        ],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-12T06:21:59.249Z",
        "activeAgent": false
      },
      {
        "id": "16",
        "title": "Implement Search/Filter Logic (plugins/taskmaster)",
        "description": "Add interactive filtering capabilities to the Taskmaster plugin, supporting text search via '/' and status filter cycling via 'f'.",
        "details": "This task focuses on enhancing the `update` loop and `State` management in `plugins/taskmaster` to support dynamic filtering of the task list.\n\n### Implementation Requirements\n\n1.  **Update `State` Struct (`src/state.rs`)**:\n    - Add `filter_query: String` to store the active text search input.\n    - Add `filter_status: Option<TaskStatus>` (or an enum wrapping it) to store the active status filter (e.g., All, Pending, In Progress, Done).\n    - Add a boolean flag `is_searching` or `input_mode` to distinguish between navigation mode and text input mode.\n\n2.  **Modify `update` Function (`src/main.rs`)**:\n    - **'/' Key**: Toggle `is_searching` mode to true. While in search mode, capture character inputs to append to `filter_query`.\n    - **'Esc' / 'Enter'**: Exit search mode. 'Esc' could clear the query or just cancel typing.\n    - **'f' Key**: Cycle through available `TaskStatus` values (All -> Pending -> In Progress -> Done -> All).\n    - **Backspace**: Handle character deletion when in search mode.\n\n3.  **Implement Filtering Logic**:\n    - Create a method `get_filtered_tasks(&self) -> Vec<&Task>` on the `State` struct.\n    - This method should filter `self.tasks` based on:\n      - Does `task.title` (or description) contain `filter_query` (case-insensitive)?\n      - Does `task.status` match `filter_status` (if set)?\n\n4.  **UI Updates (`src/ui.rs`)**:\n    - Update the rendering loop to use `get_filtered_tasks()` instead of the raw task list for the main grid.\n    - **Search Bar**: Render a search input field (perhaps in the Header HUD or a bottom bar) when `is_searching` is active or `filter_query` is not empty.\n    - **Filter Indicator**: Display the current status filter in the HUD (e.g., \"[Filter: Pending]\").",
        "testStrategy": "1. **Unit Tests**: Test `get_filtered_tasks` logic in `state.rs` with various combinations of query strings and status filters to ensure accurate subsetting.\n2. **Interactive Search**: Run the plugin, press '/', type a partial task name, and verify the grid updates in real-time to show only matching tasks.\n3. **Status Cycling**: Press 'f' repeatedly and verify the grid toggles between showing all tasks and specific statuses.\n4. **Input Handling**: Verify Backspace works correctly and Esc exits search mode without crashing.",
        "status": "done",
        "dependencies": [
          "11",
          "14",
          "15"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-12T06:22:12.353Z",
        "activeAgent": false
      },
      {
        "id": "17",
        "title": "Implement 'Assign to Agent' (plugins/taskmaster): Add 'a' key to tag tasks for active agent focus",
        "description": "Add functionality to toggle an 'active_agent' tag on tasks using the 'a' key, allowing users to designate specific tasks for immediate AI agent attention.",
        "details": "This task implements a tagging mechanism to mark tasks for active agent focus. This involves updating the data model, state management, and input handling within the Taskmaster plugin.\n\n### Implementation Requirements:\n\n1.  **Update Data Model (`src/task.rs` or `src/state.rs`)**:\n    - Add a field `pub active_agent: bool` (defaulting to false) to the `Task` struct.\n    - If `Task` is defined in an external crate (like `task_master_core` referenced in previous tasks), ensure this field is added there or managed locally in the plugin state if the core struct is immutable.\n    - Ensure serialization/deserialization logic handles this new field (e.g., `#[serde(default)]`).\n\n2.  **Modify State Management (`src/state.rs`)**:\n    - Implement a method `toggle_agent_focus(&mut self)` on the `State` struct.\n    - This method should locate the currently selected task (based on `selected_index`) and toggle its `active_agent` boolean.\n    - Persist the change back to `tasks.json` immediately to trigger any file watchers or external agent processes.\n\n3.  **Update Input Handling (`src/main.rs`)**:\n    - In the `update` loop (specifically inside the `Key::Char('a')` match arm):\n      - Call `state.toggle_agent_focus()`.\n      - Ensure the UI refreshes to reflect the change.\n\n4.  **UI Visualization (`src/ui.rs`)**:\n    - Update the task list rendering to visually distinguish tasks with `active_agent: true`.\n    - Use a specific icon (e.g., `` or a specific nerd font glyph) or a color highlight (e.g., Magenta/Purple from the Theme) next to the task status or title.\n    - Ensure the visual indicator is distinct from standard status icons.",
        "testStrategy": "1. **Unit Tests**: Test `toggle_agent_focus` in `state.rs` to verify it correctly flips the boolean flag for the selected index and handles boundary conditions (empty list).\n2. **Persistence Test**: Run the plugin, toggle a task with 'a', close the plugin, and inspect `tasks.json` to confirm the field is saved.\n3. **Visual Verification**: Launch the plugin, select a task, press 'a', and verify the agent icon/highlight appears. Press 'a' again to verify it disappears.",
        "status": "done",
        "dependencies": [
          "11",
          "14",
          "16"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-12T06:22:26.787Z",
        "activeAgent": false
      },
      {
        "id": "18",
        "title": "Implement Robust Error Handling (plugins/taskmaster)",
        "description": "Implement graceful error recovery for malformed JSON data and file I/O failures, adding a UI overlay to display errors without crashing the plugin.",
        "details": "This task focuses on preventing the plugin from panicking when encountering invalid states, particularly regarding the `tasks.json` data source. It involves updating the State model to hold error information and modifying the UI to render these errors.\n\n### Implementation Requirements\n\n1. **Update `State` Struct (`src/state.rs`)**:\n   - Add `pub error_msg: Option<String>` to the `State` struct.\n   - Implement helper methods: `set_error(msg: String)` and `clear_error()`.\n\n2. **Safe Data Loading (`src/plugin.rs`)**:\n   - Refactor the task loading logic (likely using `std::fs::read_to_string` and `serde_json::from_str`).\n   - Instead of `.unwrap()` or `.expect()`, use `match` or `if let Err(e)` patterns.\n   - On failure, capture the error message (e.g., \"JSON Syntax Error at line 10\") and call `state.set_error(...)` instead of panicking.\n\n3. **UI Error Overlay (`src/ui.rs`)**:\n   - Implement `draw_error_modal` function.\n   - Check `state.error_msg` at the beginning of the render loop. If present, render a centered box (using `Theme::error` color from Task #13) containing the message on top of the dashboard.\n   - Ensure the overlay obscures or dims the underlying content to indicate a modal state.\n\n4. **Input Handling (`src/plugin.rs`)**:\n   - In the `update` loop, if `state.error_msg` is `Some`, intercept input events.\n   - Map `Esc` or `Enter` to `state.clear_error()`, allowing the user to attempt a reload or return to a neutral state after fixing the external file.",
        "testStrategy": "1. **Malformed JSON Test**: Manually corrupt `tasks.json` (e.g., remove a closing brace) while the plugin is running (or before starting). Verify the plugin displays a red error box describing the syntax error instead of crashing.\n2. **Missing File Test**: Rename `tasks.json` to trigger an I/O error. Verify the error is caught and displayed.\n3. **Recovery Workflow**: While the error is displayed, fix `tasks.json` externally, then press `Esc`/`Enter` in the plugin. Verify the task list reloads correctly and the error message disappears.",
        "status": "done",
        "dependencies": [
          "13",
          "14"
        ],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-12T06:22:40.810Z",
        "activeAgent": false
      },
      {
        "id": "19",
        "title": "Implement Optimistic UI Updates (plugins/taskmaster)",
        "description": "Decouple UI state updates from file persistence to ensure immediate visual feedback during user interactions like toggling status or assigning agents.",
        "details": "This task focuses on making the plugin feel responsive ('snappy') by modifying the in-memory state and re-rendering immediately upon user input, rather than waiting for file I/O completion or file-watcher events.\n\n### Implementation Requirements\n\n1. **Modify Event Loop (`src/main.rs`)**:\n   - Review the `update` function where key events (e.g., 'd' for done, 'a' for agent, 'p' for priority) are handled.\n   - Currently, these likely trigger a write operation immediately. Refactor this flow.\n   \n2. **Update `State` Logic (`src/state.rs`)**:\n   - Implement specific mutation methods on the `State` struct, e.g., `pub fn optimistic_update_status(&mut self, index: usize, status: TaskStatus)`.\n   - Ensure these methods update both the raw task list and the filtered view (referencing Task #16 logic) immediately.\n\n3. **Persistence Strategy**:\n   - After the in-memory mutation and render call, perform the blocking file I/O to save `tasks.json`.\n   - If the I/O operation fails, utilize the error handling mechanism from Task #18 (`state.set_error()`) to notify the user, and optionally revert the local state change by reloading from disk.\n\n4. **Visual Consistency**:\n   - Ensure that when the file watcher eventually triggers (if applicable), it does not cause a 'stutter' if the on-disk state matches the current optimistic in-memory state.",
        "testStrategy": "1. **Latency Test**: Temporarily inject a `std::thread::sleep` of 500ms into the file writing function. Run the plugin and press 'd'. Verify the checkmark appears *instantly*, before the sleep finishes.\n2. **Persistence Verification**: After the instant update, verify `tasks.json` is correctly updated on disk.\n3. **Filter Interaction**: Apply a filter (e.g., show only 'Pending'). Mark a task as 'Done'. Verify it disappears from the view immediately without requiring a manual refresh.",
        "status": "done",
        "dependencies": [
          "14",
          "16",
          "18"
        ],
        "priority": "low",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-12T06:22:54.510Z",
        "activeAgent": false
      },
      {
        "id": "20",
        "title": "Fix Taskmaster plugin root selection for new AOC tabs",
        "description": "Ensure Taskmaster plugin reads project root from the shared root file instead of stale server env vars so new tabs load correctly.",
        "details": "Adjust plugin state loading to avoid locking root to AOC_PROJECT_ROOT/ZELLIJ_PROJECT_ROOT and prefer root_file when resolving root via command.",
        "testStrategy": "Rebuild the Taskmaster plugin and open a new AOC tab from an existing session; confirm tasks render in the Taskmaster pane and root matches the tab cwd.",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-12T13:58:44.521Z",
        "activeAgent": false
      },
      {
        "id": "21",
        "title": "Validate and Refine Per-Tab Root Isolation for Multi-Project Workflows",
        "description": "Verify and harden the root isolation mechanism across aoc-launch, aoc-new-tab, aoc-align, and aoc-star to ensure concurrent Zellij tabs can operate on distinct projects without state leakage.",
        "details": "This task focuses on integration testing and refinement of the project root management strategy implemented in Task #20. The goal is to ensure that opening multiple AOC tabs (even in the same Zellij session) allows each tab to maintain a unique project context.\n\n### Analysis & Implementation Steps\n\n1.  **Review Shell Scripts (`bin/`)**:\n    -   Analyze `bin/aoc-launch` and `bin/aoc-new-tab`. Verify how `AOC_PROJECT_ROOT` is propagated to the new tab layout.\n    -   Ensure `aoc-new-tab` creates a unique context (e.g., by ensuring the `.root` file or environment variable is scoped to the tab or strictly passed via layout parameters).\n    -   Check `bin/aoc-align` (pane alignment) and `bin/aoc-star` (task creation) to ensure they respect the *current* tab's root, not a global variable.\n\n2.  **Verify Plugin Behavior (`plugins/taskmaster`)**:\n    -   The `taskmaster` plugin (Rust) reads a root path. Based on Task #20, it prioritizes a root file. Ensure this file lookup is tab-aware (e.g., checking the current working directory or a specific tab-local environment variable provided by Zellij) rather than reading a singleton global file if multiple tabs exist.\n    -   If the plugin relies on `ZELLIJ_SESSION_NAME` or strictly on `CWD`, confirm that `aoc-launch` starts the plugin in the correct directory.\n\n3.  **Refactor for Tab-Local State (if needed)**:\n    -   If `aoc-new-tab` currently overwrites a global `/tmp/aoc.root` file (implying a race condition between tabs), refactor it to pass the root directly into the Zellij layout template or set a tab-scoped environment variable if supported.\n    -   Alternatively, verify the plugin logic strictly prefers `std::env::current_dir()` as the source of truth when no explicit root argument is provided.\n\n4.  **Edge Case Handling**:\n    -   Test scenarios where a user navigates `cd ..` in a shell pane. Does `aoc-star` still pick up the original project root or the new directory? (Should likely stick to the project root defined at launch).",
        "testStrategy": "1. **Multi-Tab Setup**: Open a Zellij session. Use `aoc-launch` to start Project A in Tab 1. Use `aoc-new-tab` to start Project B in Tab 2.\n2. **Verification**:\n   - **Visual**: Confirm the Taskmaster pane in Tab 1 shows Project A tasks, and Tab 2 shows Project B tasks.\n   - **Action**: Run `aoc-star \"Task A\"` in Tab 1 and `aoc-star \"Task B\"` in Tab 2. Verify `Task A` appears only in Project A's `tasks.json` and `Task B` only in Project B's.\n3. **Cross-Pollination Check**: Switch back to Tab 1 and refresh. Ensure Project B data has not leaked into the view.\n4. **Tool Check**: Run `aoc-align` in both tabs to ensure panes resize correctly according to their specific layout context.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-17T17:23:11.961Z",
        "activeAgent": false
      },
      {
        "id": "22",
        "title": "Verify and Harden Idle Session Lifecycle Management (aoc-session-watch)",
        "description": "Implement and verify the `aoc-session-watch` utility to handle session detach events by renaming sessions to `idle-*`, pruning heavy UI processes, and restoring the full layout upon reattachment.",
        "details": "This task focuses on the lifecycle management of Zellij sessions to optimize resource usage when sessions are not in focus (detached). The `aoc-session-watch` script acts as a daemon or hook that monitors session state.\n\n### Implementation Requirements\n\n1.  **Create/Update `bin/aoc-session-watch`**:\n    -   **Detach Handler**: Detect when the current client detaches. Rename the session from `[name]` to `idle-[name]` using `zellij action rename-session`.\n    -   **Pruning Logic**: When entering 'idle' state, identify and terminate resource-heavy UI processes that are not essential for background agent work (e.g., `yazi`, `chafa`, `k9s`). **Crucially**, ensure the Agent process (LLM loop) and the Taskmaster plugin remain running.\n    -   **Reattach Handler**: When a client attaches to an `idle-[name]` session, rename it back to `[name]` (removing the prefix).\n    -   **Layout Restoration**: Upon reattach, verify if panes were closed or if the layout needs to be re-applied to restore the UI tools (e.g., respawning the file browser pane if it was killed).\n\n2.  **Integration with `aoc-launch`**:\n    -   Ensure `aoc-launch` starts `aoc-session-watch` in the background or as a daemon pane within the session.\n\n3.  **Safety Checks**:\n    -   Prevent renaming if the session is already active elsewhere (multi-client scenarios).\n    -   Ensure PID tracking logic is robust so it doesn't kill the wrong processes.",
        "testStrategy": "1. **Resource Monitoring**: Launch a session with a heavy process (e.g., `btm` or a mocked CPU spinner). Detach. Verify via `htop` outside the session that the process is terminated/suspended and the session is renamed to `idle-*`.\n2. **Agent Persistence**: Ensure a running mock agent script continues writing to logs/files while the session is idle.\n3. **Restoration**: Reattach to the session. Confirm the session name reverts. Verify that killed UI panes (like file explorer) are automatically respawned or the layout is reloaded correctly.",
        "status": "done",
        "dependencies": [
          "21"
        ],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-17T17:40:07.296Z",
        "activeAgent": false
      },
      {
        "id": "23",
        "title": "Verify and Implement Tab-Close Process Cleanup in aoc-session-watch",
        "description": "Implement the `trim_closed_tab_processes` function in `aoc-session-watch` to detect closed Zellij tabs and terminate associated background processes (like file watchers or servers) to prevent resource leaks.",
        "details": "This task addresses the issue of orphaned processes remaining after an AOC tab is closed. The implementation should leverage `zellij action query-tab-names` and process tree analysis.\n\n### Implementation Requirements\n\n1.  **Enhance `bin/aoc-session-watch`**:\n    -   **State Tracking**: Maintain an in-memory list or temp file tracking active Tab IDs and their associated PIDs (if detectable via Zellij's layout info or by tagging processes during launch).\n    -   **Polling/Event Loop**: Regularly (e.g., every 2-5 seconds) query the current list of open tabs using `zellij action query-tab-names`.\n    -   **Diff Logic**: Compare the current list of tabs against the previous state.\n    -   **`trim_closed_tab_processes()` Implementation**:\n        -   Identify tabs that were present in the previous state but missing in the current state.\n        -   If a mechanism exists to map Tab ID -> PIDs (e.g., via `zellij action list-clients` or inspecting the pane tree), iterate through those PIDs.\n        -   Send `SIGTERM` to the identified process groups (`pgid`) to ensure child processes (like `npm run dev`) are also cleaned up.\n        -   *Note*: Since Zellij may not expose PIDs per tab directly in CLI, consider an approach where `aoc-launch` writes a PID file keyed by Tab ID (e.g., `/tmp/aoc/pids/<session>_<tab_id>.pid`) which `aoc-session-watch` reads and cleans up.\n\n2.  **PID Tracking Integration (Optional but likely needed)**:\n    -   Modify `bin/aoc-launch` or `bin/aoc-new-tab` to record the PID of the primary process launched in the tab into a registry directory.",
        "testStrategy": "1. **Orphan Test**: Launch a heavy process (e.g., `python3 -m http.server 9999`) in a new AOC tab. Note its PID via `ps aux | grep python`. Close the tab via Zellij keybinding (Ctrl+t, x). Wait 5 seconds. Verify the PID no longer exists in `ps aux`.\n2. **Registry Verification**: Check that the temporary PID tracking files are correctly created on tab open and deleted on tab close.\n3. **Multiple Tabs**: Open 3 tabs. Close the middle one. Ensure only the middle tab's processes are killed.",
        "status": "done",
        "dependencies": [
          "22"
        ],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-17T17:47:05.092Z",
        "activeAgent": false
      },
      {
        "id": "24",
        "title": "Fix Taskmaster Plugin Scrollback Growth and Render Throttling",
        "description": "Implement state comparison logic to prevent redundant UI rendering and endless scrollback growth by ensuring the plugin only repaints when data or UI state actually changes.",
        "details": "This task addresses performance issues where the Taskmaster plugin may be re-rendering frames unnecessarily, causing high CPU usage or scrollback pollution. \n\n### Implementation Steps:\n1. **State Tracking (`src/state.rs`)**: \n   - Add a field to the `State` struct to track the signature of the last rendered frame (e.g., `last_render_signature: u64` or a clone of the relevant state subset).\n   - Implement a method `get_render_signature(&self)` that hashes or captures key UI state components: the tasks list (content and status), selected index, current filter mode, and any active error message.\n\n2. **Render Logic (`src/main.rs`)**:\n   - In the `render` method (or the main event loop handler), generate the signature for the current state.\n   - Compare the current signature with `state.last_render_signature`.\n   - If they match, return early without printing to stdout (printing ANSI codes to the terminal is what causes scrollback growth).\n   - If they differ, proceed with rendering and update `state.last_render_signature`.\n\n3. **Event Loop Optimization**:\n   - Review the `update` function. Ensure that events which do not affect visual state (e.g., file watcher ticks that result in identical data) do not trigger the `should_render` flag.\n   - Specifically, when reloading `tasks.json`, compare the new loaded data with the existing memory data. Only set `should_render = true` if the data differs.",
        "testStrategy": "1. **Idleness Verification**: Launch the plugin in Zellij. Do not interact with it. Monitor Zellij logs (or use `strace` on the plugin process if applicable) to verify the `render` function is not being called repeatedly in a loop while idle.\n2. **Interaction Verification**: Move the cursor and mark tasks as done. Verify the UI updates immediately (preserving the functionality from Task #19).\n3. **Redundant Data Test**: Manually `touch .taskmaster/tasks/tasks.json` without changing content. Verify visually that the screen does not flicker or reprint unnecessarily.",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-17T17:30:50.862Z",
        "activeAgent": false
      },
      {
        "id": "25",
        "title": "Fix Tmux Cleanup Configuration for Agent Panes",
        "description": "Configure tmux sessions for agent tools (opencode, codex) with 'destroy-unattached' and 'exit-empty' to ensure servers terminate automatically when the parent Zellij pane or tab is closed.",
        "details": "This task addresses resource leaks where tmux servers spawned by agent scripts remain active after the UI pane is closed. The implementation involves modifying the tmux startup commands in the agent wrapper scripts.\n\n### Implementation Steps\n\n1.  **Analyze Agent Launch Scripts**:\n    -   Locate scripts in `bin/` or `agents/` that invoke `tmux`. Likely candidates include `bin/opencode` or similar wrappers.\n    -   Identify the `tmux new-session` command lines.\n\n2.  **Apply Configuration Flags**:\n    -   Update the tmux invocation to include specific server configuration options via the `-f` config file argument or by passing configuration commands with `set-option`.\n    -   Ensure `set-option -g destroy-unattached on` is applied. This ensures the session is killed when no clients are attached (i.e., when the Zellij pane hosting the client closes).\n    -   Ensure `set-option -g exit-empty on` is applied (default behavior, but explicit setting prevents regressions).\n\n3.  **Refine Socket Handling**:\n    -   If the agents use named sockets (`-S /tmp/tmux-agent-socket`), ensure the cleanup logic or the socket location allows for automatic removal, or verify that `destroy-unattached` handles the socket cleanup correctly.\n\n4.  **Example Modification**:\n    ```bash\n    # Before\n    tmux -S \"$SOCKET\" new-session -s \"$SESSION_NAME\" -d\n    \n    # After\n    tmux -S \"$SOCKET\" new-session -s \"$SESSION_NAME\" -d\n    tmux -S \"$SOCKET\" set-option -g destroy-unattached on\n    tmux -S \"$SOCKET\" set-option -g exit-empty on\n    ```\n\n5.  **Integration with AOC Lifecycle**:\n    -   Review interaction with `aoc-session-watch` (Task #22) to ensure these settings don't conflict with intended idle states, though agent panes usually should die if the UI is gone.",
        "testStrategy": "1. **Orphan Check**: Open an agent pane (e.g., run `opencode`). Verify the tmux server process exists (`ps aux | grep tmux`). Close the Zellij pane containing the agent. Verify the tmux process terminates immediately.\n2. **Re-attach Test**: Launch the agent, detach the Zellij session, and re-attach. Ensure the agent tmux session persists (since the client detached but the session wasn't destroyed/closed, just hidden). Close the tab completely and verify termination.",
        "status": "done",
        "dependencies": [
          "23"
        ],
        "priority": "low",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-17T17:52:39.738Z",
        "activeAgent": false
      },
      {
        "id": "26",
        "title": "Enhance Yazi with Status Bar Tips and Pane Resize on File Open",
        "description": "Add Zellij-style command tips to Yazi status bar and implement automatic pane expansion when opening files for better visibility.",
        "details": "This task improves the Yazi file manager UX within AOC by:\\n\\n1. **Status Bar Tips**: Added `init.lua` that displays command hints at the bottom of the Yazi status bar (matching Zellij's status bar style with Catppuccin colors).\\n2. **Pane Resize Plugin**: Created `aoc-open.yazi` plugin that expands the Yazi pane to ~40% when opening a file, allowing users to see the file content clearly while keeping other AOC panes visible.\\n3. **Theme Styling**: Added `theme.toml` with Catppuccin-inspired colors for file types.\\n4. **Keybindings**: Updated `keymap.toml` with Enter override for open+resize, and `e` for direct edit.\\n\\n### Files Created/Modified:\\n- `yazi/init.lua` - Status bar command tips\\n- `yazi/theme.toml` - File type colors\\n- `yazi/keymap.toml` - Updated keybindings\\n- `yazi/plugins/aoc-open.yazi/main.lua` - Resize on open plugin\\n- `install.sh` - Updated to install new files\\n- `README.md` - Documentation added",
        "testStrategy": "1. Run `./install.sh` to deploy the new config files.\\n2. Launch AOC and verify Yazi status bar shows command tips at the bottom.\\n3. Press Enter on a file and confirm the Yazi pane expands.\\n4. Press `e` to edit a file and confirm it opens in $EDITOR.",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-17T18:00:00.000Z",
        "activeAgent": false
      },
      {
        "id": "27",
        "title": "Refactor Context System to .aoc/ and Universal Agent Injection",
        "description": "Migrate the project configuration directory from .gemini/ to .aoc/ and implement a standardized mechanism to inject project context into any AI agent session.",
        "details": "This task unifies the context management system, moving away from provider-specific naming (.gemini) to a generic project directory (.aoc). It also standardizes how context is loaded and injected.\n\n### Implementation Requirements\n\n1. **Directory Migration & Install Logic**:\n   - Update `install.sh` and `bin/` scripts to use `$HOME/.aoc` (or project-local `.aoc/`) instead of `.gemini/`.\n   - Implement a migration check: If `.gemini/` exists and `.aoc/` does not, move/rename it automatically.\n   - Update `.gitignore` to exclude `.aoc/`.\n\n2. **Context Structure Definition**:\n   - Standardize the `.aoc/` structure:\n     - `config.json`: Global settings (API keys references, preferred model).\n     - `system/`: System prompts.\n     - `project/`: Project-specific context files (architecture, patterns).\n\n3. **Universal Injection Utility**:\n   - Create or refactor a utility (e.g., `bin/aoc-context` or a Rust module `src/context.rs`) that aggregates files from `.aoc/project/` and `.aoc/system/` into a single context payload.\n   - Ensure this payload can be piped into different agent backends (Gemini, local LLMs, etc.).\n\n4. **Taskmaster Integration**:\n   - Update `plugins/taskmaster/src/state.rs` or `model.rs` to read configuration and context paths from the new `.aoc/` location.\n   - Ensure the 'Assign to Agent' feature (Task 17) pulls the correct system prompt from this new location.",
        "testStrategy": "1. **Migration Verification**: Create a dummy `.gemini` folder, run the updated setup/install script, and verify it is renamed to `.aoc`.\n2. **Context Aggregation**: Populate `.aoc/project/` with two Markdown files. Run the injection utility and verify the output contains the text from both files.\n3. **Plugin Integration**: Launch the Taskmaster plugin. Verify it starts without errors (locating the new config) and that agent actions successfully retrieve the context.",
        "status": "done",
        "dependencies": [
          "6",
          "11",
          "17",
          "18"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-17T19:53:49.855Z",
        "activeAgent": false
      },
      {
        "id": "28",
        "title": "Implement RLM (Recursive Language Model) Skill for AOC",
        "description": "Create a new RLM skill module that enables recursive task decomposition and execution using LLM interactions within the Agent Ops Cockpit.",
        "details": "This task focuses on integrating a Recursive Language Model (RLM) capability into the AOC backend. This skill allows the system to take a high-level goal, break it down into sub-tasks using an LLM, and recursively execute or refine those sub-tasks.\n\n### Implementation Requirements\n\n1.  **Create Skill Module (`src/skills/rlm.rs`)**:\n    -   Define an `RlmSkill` struct implementing the `Skill` trait (if one exists, otherwise define a standard interface with `execute` and `help` methods).\n    -   Implement the `execute` method to accept a prompt/goal string.\n\n2.  **LLM Integration**:\n    -   Integrate with an LLM provider (e.g., via `reqwest` to OpenAI API or a local endpoint like Ollama). Use environment variables for API keys/endpoints.\n    -   Design a system prompt that instructs the LLM to output a JSON structure representing the breakdown of the task (e.g., `[{ \"step\": 1, \"description\": \"...\" }, ...]`).\n\n3.  **Recursive Logic**:\n    -   Implement the logic to parse the LLM's response.\n    -   For each sub-task identified, create a new `Task` entry in the system (leveraging the existing Task model).\n    -   If a sub-task is complex (based on complexity heuristics or LLM flagging), recursively call the RLM logic on that specific sub-task (up to a defined `MAX_DEPTH`).\n\n4.  **Integration with Taskmaster**:\n    -   Ensure generated tasks are persisted to `tasks.json` so they appear in the UI.\n    -   Add a command or keybinding (e.g., in `plugins/taskmaster`) to trigger this skill on the currently selected task.",
        "testStrategy": "1. **Mocked LLM Test**: Create a unit test for `RlmSkill` using a mocked HTTP client. Verify that a sample JSON response from the 'LLM' is correctly parsed into a list of `Task` objects.\n2. **Recursion Depth Test**: Verify that the recursion logic respects the `MAX_DEPTH` constant to prevent infinite loops.\n3. **End-to-End Flow**: Trigger the RLM skill on a generic task like 'Plan a party' via the UI/CLI. Check `tasks.json` to ensure valid subtasks (e.g., 'Buy food', 'Invite guests') are created and linked to the parent task.",
        "status": "cancelled",
        "dependencies": [
          "18",
          "19",
          "15"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-17T20:24:33.386Z",
        "activeAgent": false
      },
      {
        "id": "29",
        "title": "Implement RLM CLI Tool and Protocol (bin/aoc-rlm)",
        "description": "Develop the standalone `aoc-rlm` binary for recursive task decomposition, update initialization templates, and document the IPC protocol.",
        "details": "This task creates the external executable responsible for the heavy lifting of the Recursive Language Model (RLM) skill. \n\n### Implementation Requirements\n\n1. **Create `bin/aoc-rlm`**:\n   - Initialize a new Rust binary crate within the workspace.\n   - Implement argument parsing using `clap` (arguments: `--goal`, `--context`, `--depth`, `--model`).\n   - **LLM Client**: Implement `src/llm.rs` using `reqwest` to interface with OpenAI/Anthropic APIs. It must handle prompt construction for recursive decomposition.\n   - **Recursion Logic**: Implement `src/engine.rs` to process the goal, receive LLM response, parsing the JSON list of steps. If current depth < max depth, recursively process complex steps.\n\n2. **Protocol Definition**:\n   - Create `docs/RLM_PROTOCOL.md` defining the JSON schema for Input (Goal/Context) and Output (Task Tree).\n   - Output format must align with the `Task` struct structure used in `plugins/taskmaster` (Task 15).\n\n3. **Update `aoc-init`**:\n   - Modify `bin/aoc-init` (or relevant init script) to generate a default `.aoc-rlm-config.toml` in new projects, specifying default models and depth limits.",
        "testStrategy": "1. **CLI Mock Test**: Run `cargo run --bin aoc-rlm -- --goal 'Test' --dry-run` to verify argument parsing and configuration loading without hitting the LLM.\n2. **Protocol Compliance**: Feed a sample JSON input to the binary and validate that the output JSON strictly matches the schema required by the Taskmaster plugin (Task 15).\n3. **Recursion Limit Test**: configure max depth to 1, provide a complex goal, and ensure the output contains flat steps without further nested recursion.",
        "status": "done",
        "dependencies": [
          "28",
          "15",
          "18"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-17T20:23:36.342Z",
        "activeAgent": false
      },
      {
        "id": "30",
        "title": "Implement Reactive Context Watcher Service",
        "description": "Create a background service that monitors file system changes and automatically regenerates `context.md` to ensure the AI agent always possesses up-to-date project context.",
        "details": "This task involves creating a new binary or extending an existing one to watch for file changes in the project root and update a centralized context file. \n\n### Implementation Requirements\n\n1. **Service Architecture**:\n   - Implement as a subcommand in `aoc-session-watch` or a new binary `bin/aoc-context-watcher`.\n   - Use the `notify` crate for cross-platform file system monitoring.\n   - **Configuration**: Support a `.contextignore` file (or respect `.gitignore`) to prevent irrelevant updates (e.g., `target/`, `.git/`, `node_modules/`).\n\n2. **Context Generation Logic**:\n   - Create a module `src/context_gen.rs`.\n   - Implement `generate_context_file(root: &Path, output: &Path)`.\n   - This function should traverse the project, collect file structures (using `walkdir`), and aggregate specific file contents (e.g., `README.md`, `src/main.rs`, `Cargo.toml`).\n   - **Debouncing**: Implement a debounce mechanism (e.g., 500ms-2s) to prevent thrashing during rapid file edits (using `tokio::time` or a dedicated debounce channel).\n\n3. **Integration**:\n   - Ensure the service runs in the background, perhaps managed by the same process lifecycle as `aoc-session-watch`.\n   - Write the output to a designated location like `.aoc/context.md` or root `context.md`.\n\n4. **Performance Optimization**:\n   - Limit the size of included files (e.g., skip files > 100KB).\n   - Only rebuild the sections that changed if possible, or do a full rebuild if simplicity is preferred for V1.",
        "testStrategy": "1. **Watcher Test**: Run the service, modify a monitored file (e.g., `src/main.rs`), and verify that the `context.md` file's modification timestamp updates within the debounce window.\n2. **Content Verification**: Add a dummy file `test_context_gen.txt`, wait for update, and grep `context.md` to ensure the new file's content is present.\n3. **Ignore Logic**: Modify a file in `target/` and verify `context.md` is NOT updated.\n4. **Debounce Check**: Save a file 5 times in 1 second; verify `context.md` is updated only once at the end.",
        "status": "done",
        "dependencies": [
          "23"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-18T10:13:23.237Z",
        "activeAgent": false
      },
      {
        "id": "31",
        "title": "Refactor Agent Attribution to Support Multi-Agent Identification",
        "description": "Replace the binary attribution flag in the Task model with an optional Agent ID to distinguish between specific agents and user actions.",
        "details": "The current `Task` model uses a boolean (likely `is_agent`) to denote automated tasks, limiting the system to a single implied agent source. This refactor introduces precise attribution.\n\n### Implementation Requirements\n\n1. **Model Refactor (`plugins/taskmaster/src/model.rs`)**:\n   - Update the `Task` struct definition.\n   - Replace the `is_agent` boolean field with `agent_id: Option<String>` (or a custom `AgentId` type).\n   - Implement `serde` attributes or a custom deserializer to ensure backward compatibility: `is_agent: true` in existing JSON should map to `agent_id: Some(\"generic_agent\".into())`.\n\n2. **UI Enhancements (`plugins/taskmaster/src/ui.rs`)**:\n   - Update the render loop to check `agent_id.is_some()` for automated task styling.\n   - Display the specific Agent ID (e.g., \"RLM\", \"Planner\") in the task detail view or as a badge in the list view if space permits.\n\n3. **Integration**:\n   - Ensure `src/state.rs` preserves this new field during task updates.\n   - Update any internal task creation logic to allow passing an Agent ID.",
        "testStrategy": "1. **Migration Unit Test**: Create a test case with a JSON string matching the old schema (`{\"is_agent\": true}`) and assert it deserializes into `agent_id: Some(...)`.\n2. **Round-Trip Test**: Verify that saving and loading the new structure preserves the specific Agent ID strings.\n3. **Visual Verification**: Manually inject a task with `agent_id: \"RLM\"` into the data file and verify the UI distinguishes it from user tasks.",
        "status": "done",
        "dependencies": [
          "11"
        ],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": null,
        "activeAgent": false
      },
      {
        "id": "32",
        "title": "Implement aoc-doctor Version Validation",
        "description": "Enhance the aoc-doctor utility to validate installed tool versions against defined requirements, reporting mismatches or missing dependencies.",
        "details": "This task focuses on implementing the core logic for `aoc-doctor` to parse a requirements file (e.g., `.tool-versions` or a section in `package.json`/`Cargo.toml`) and compare current system versions against these constraints.\n\n### Implementation Requirements\n\n1.  **Define Requirements Schema**:\n    -   Create a struct `ToolRequirement` with fields: `name` (String), `command` (String), `version_args` (Vec<String>), `version_regex` (String), and `required_version` (String/SemVer).\n    -   Decide on a configuration source (embedded default list + optional `aoc-tools.json` in project root).\n\n2.  **Implement Version Extraction**:\n    -   Create a function `get_tool_version(cmd: &str, args: &[&str]) -> Result<String>` using `std::process::Command`.\n    -   Implement regex matching to extract clean version numbers from output strings (e.g., capturing `1.70.0` from `cargo 1.70.0 (ec8...`).\n\n3.  **Implement SemVer Comparison**:\n    -   Utilize the `semver` crate to parse both the extracted version and the required version string.\n    -   Implement logic to determine if the installed version satisfies the requirement (e.g., `>=`).\n\n4.  **CLI Output Formatting**:\n    -   Update `bin/aoc-doctor` to output a checklist.\n    -   Use green checkmarks for pass, red crosses for fail/missing.\n    -   Example output: `[] cargo (1.75.0 >= 1.70.0)`.\n\n### targeted Tools\n-   `cargo`, `node`, `npm`, `zellij`.",
        "testStrategy": "1. **Mock Command Test**: Create unit tests that mock `Command` output to simulate various version strings (standard, non-standard, missing command) and verify the regex extraction logic.\n2. **SemVer Logic Test**: specific unit tests for the comparison logic (e.g., ensure 1.2.0 fails if requirement is >=1.3.0).\n3. **Integration Run**: Run `aoc-doctor` locally and verify it correctly identifies the versions of Cargo and Node installed on the dev machine.",
        "status": "done",
        "dependencies": [
          "18",
          "30"
        ],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": null,
        "activeAgent": false
      },
      {
        "id": "33",
        "title": "Implement Live Context Handshake for Long-Running Sessions",
        "description": "Develop a mechanism to detect context staleness in active agent sessions and implement a re-handshake protocol to inject updated context without restarting the session.",
        "details": "This task addresses the architectural gap where long-running agent sessions rely on context loaded at startup, leading to hallucinations or errors when the underlying project state changes. \n\n### Implementation Requirements\n\n1. **Context Hash/Version Tracking**:\n   - Enhance `aoc-context-watcher` (Task #30) to maintain a hash or timestamp of the aggregated `context.md`.\n   - Expose this version identifier via a lightweight local endpoint or file (e.g., `.aoc/context.version`).\n\n2. **Staleness Detection Middleware**:\n   - In the agent interaction loop (likely within `aoc-client` or the main session handler), check the current context version before every Nth prompt or after a set time interval.\n   - Compare the session's loaded context version with the live version from the file system.\n\n3. **Re-Handshake Protocol**:\n   - If staleness is detected, trigger a 'Soft Reset' or 'Context Refresh' flow.\n   - Construct a system prompt injection: \"[SYSTEM NOTICE: Project Context Updated. Discard previous file state assumptions. New context loaded below.]\".\n   - Append the new content of `.aoc/context.md` to the conversation history or replace the system prompt if the LLM provider API supports it (e.g., updating the system message in the chat array).\n\n4. **Configuration**:\n   - Add `auto_refresh_context: boolean` to the agent configuration.\n   - Add `refresh_interval_seconds: number` to control check frequency.\n\n### Resolution Note\n\nMarked complete: live refresh deferred while Mission Control and the watcher are paused; rely on startup handshake plus manual refresh (restart agent or open a new AOC tab).",
        "testStrategy": "1. **Staleness Trigger Test**: Start a mock long-running session. Modify a file in the project. assert that the next agent interaction triggers a context reload log/event.\n2. **Injection Verification**: Inspect the conversation logs to ensure the updated context text is actually sent to the LLM in the subsequent request.\n3. **Stability Test**: Ensure the re-handshake doesn't confuse the agent or wipe out the conversation memory (history of *actions* should remain, only *project state* knowledge updates).",
        "status": "done",
        "dependencies": [
          "27",
          "30"
        ],
        "priority": "low",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-30T15:22:12.030Z",
        "activeAgent": false
      },
      {
        "id": "34",
        "title": "Harden and Expand Yazi Preview Script",
        "description": "Refactor the Yazi previewer to support rich media, robust fallback mechanisms, and enhanced syntax highlighting for the Agent Ops Cockpit file manager.",
        "details": "This task involves rewriting or significantly upgrading `yazi/preview.sh` to handle the diverse file types encountered in agent operations, utilizing the toolchain verified by `aoc-doctor`.\n\n### Implementation Requirements\n\n1.  **Robust Dispatcher Logic**:\n    -   Replace simple extension checks with `file --mime-type` detection for accuracy.\n    -   Implement a `has_command` utility function to check for tool availability before execution, allowing graceful degradation (e.g., if `chafa` is missing, fall back to `file` info).\n\n2.  **Expanded Format Support**:\n    -   **Images**: Optimize `chafa` arguments (`--symbols block --size ...`) for clearer terminal graphics.\n    -   **PDFs**: Implement previewing using `pdftoppm -jpeg -f 1 -singlefile` (from `poppler-utils`) piped to `chafa` for first-page rendering.\n    -   **Media**: Use `ffmpeg` to extract a thumbnail frame for videos, and `ffprobe` to display metadata for audio files.\n    -   **Structured Data**: Use `jq` for colored `.json` output and `column -t -s,` for readable `.csv` rendering.\n    -   **Archives**: Use `bsdtar`, `unzip`, or `7z` list modes to display the contents of archive files.\n\n3.  **Code & Text**:\n    -   Integrate `bat` with forced color output (`--color=always --style=plain`) for syntax highlighting, ensuring compatibility with Yazi's escape sequence handling.\n\n4.  **Performance & Safety**:\n    -   Add `timeout` logic to prevent preview generators from hanging the UI on corrupted or massive files.\n    -   Ensure the script passes the shellcheck workflow established in Task #8.",
        "testStrategy": "1. **Asset Matrix Validation**: Create a `tests/fixtures/previews` directory containing sample files for every supported type (valid JSON, invalid JSON, PDF, MP4, PNG, CSV, varying encodings).\n2. **Dry Run Verification**: Execute the script manually from the terminal: `./yazi/preview.sh path/to/fixture 10 10 100 100` (simulating geometry arguments) and assert standard output contains expected ANSI codes or graphic data.\n3. **Degradation Test**: Temporarily uninstall or mask binary dependencies (e.g., `alias chafa=false`) and verify the script falls back to text metadata or generic icons without crashing.",
        "status": "done",
        "dependencies": [
          "1",
          "8"
        ],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-18T10:59:03.577Z",
        "activeAgent": false
      },
      {
        "id": "35",
        "title": "Polish Yazi Interface and Keybindings",
        "description": "Refine the Yazi file manager configuration to fix status bar labeling, improve the smart status line logic, and enhance pane resizing behavior for better workflow integration.",
        "details": "This task builds upon the initial Yazi enhancements (Task #26) to address visual inconsistencies and logic refinements. The goal is to ensure the custom status bar correctly displays labels and that the automated pane resizing logic is robust.\n\n### Implementation Requirements\n\n1.  **Fix Status Bar Labels (`yazi/init.lua`)**:\n    -   Review the custom status line implementation (Header:children). Currently, the 'Help' label is hardcoded or misaligned.\n    -   Update the status bar widget to dynamically reflect available keybindings or fix static labels to match the actual keymap (e.g., ensure 'Open', 'Select', 'Exit' labels are accurate).\n    -   Ensure the background and foreground colors of the labels transition smoothly without visual artifacts.\n\n2.  **Refine Smart Status Logic**:\n    -   Modify the status bar to show contextual information relevant to the AOC workflow (e.g., current git branch if possible, or specialized file info).\n    -   Ensure the status bar layout respects the `1:4:3` column ratio set in `yazi.toml` and doesn't overlap with the preview pane borders.\n\n3.  **Enhance Resize Logic (`plugins/aoc-open.yazi`)**:\n    -   The current resize logic (expanding to ~40%) might conflict with Zellij's own layout management or cause flickering.\n    -   Investigate utilizing `zellij action resize` commands more effectively within the Lua wrapper if possible, or adjust the resize step to be smoother.\n    -   Add logic to revert the resize (restore layout) when Yazi loses focus or when the file is closed, if not already handled.\n\n4.  **Keybinding & Config Polish**:\n    -   Finalize `yazi/keymap.toml` to ensure `g a` (.aoc), `g l` (logs), and `g c` (config) shortcuts work as intended.\n    -   Verify `Ctrl+t` behavior for task switching integration.\n    -   Ensure `yazi/theme.toml` colors are fully aligned with the Catppuccin/AOC palette used in Task #26.",
        "testStrategy": "1. **UI Verification**: Launch Yazi and inspect the status bar. Confirm that labels like 'Help', 'Open', etc., are correctly positioned and colored.\n2. **Resize Test**: Open a file from Yazi. Verify the pane expands. Close the file or switch focus and verify behavior is consistent/predictable.\n3. **Keybinding Check**: Test `g a` to jump to `.aoc/`. Test `Ctrl+t` functionality.",
        "status": "done",
        "dependencies": [
          "34",
          "26"
        ],
        "priority": "low",
        "subtasks": [
          {
            "id": 1,
            "title": "Fix Status Bar Labels in init.lua",
            "description": "Refactor the Header:children method in yazi/init.lua to correctly display 'Help', 'Open', 'Select', and 'Exit' labels with proper alignment and color transitions.",
            "status": "pending",
            "dependencies": [],
            "priority": "",
            "activeAgent": false,
            "testStrategy": "",
            "details": "",
            "subtasks": null
          },
          {
            "id": 2,
            "title": "Implement Contextual Smart Status",
            "description": "Update the status bar to display contextual info such as Git branch or file metadata, respecting the column layout.",
            "status": "pending",
            "dependencies": [
              "1"
            ],
            "subtasks": null,
            "priority": "",
            "testStrategy": "",
            "activeAgent": false,
            "details": ""
          },
          {
            "id": 3,
            "title": "Enhance Pane Resize Logic in aoc-open plugin",
            "description": "Optimize the resize behavior in plugins/aoc-open.yazi to handle Zellij interactions smoothly and restore layout on exit.",
            "status": "pending",
            "dependencies": [],
            "priority": "",
            "activeAgent": false,
            "subtasks": null,
            "details": "",
            "testStrategy": ""
          },
          {
            "id": 4,
            "title": "Finalize Keybindings and Theme Polish",
            "description": "Configure yazi/keymap.toml for 'g a', 'g l', 'g c' and Ctrl+t, and sync colors in yazi/theme.toml.",
            "status": "pending",
            "dependencies": [],
            "testStrategy": "",
            "activeAgent": false,
            "subtasks": null,
            "priority": "",
            "details": ""
          }
        ],
        "aocPrd": null,
        "updatedAt": "2026-01-18T11:13:22.886Z",
        "activeAgent": false
      },
      {
        "id": "36",
        "title": "Initialize aoc-core Crate and Shared Data Models",
        "description": "Establish the shared Rust library `aoc-core` and implement standardized data structures for Task, Memory, and Context to unify types across the system.",
        "details": "This task creates the foundational library for the Rust migration, centralizing data definitions currently scattered across plugins and scripts.\n\n### Implementation Requirements\n\n1.  **Workspace Setup**:\n    -   Create a `crates/` directory in the project root.\n    -   Initialize a new library: `cargo new --lib crates/aoc-core`.\n    -   Update the root `Cargo.toml` (if it exists as a workspace) or create one to include `crates/aoc-core` as a member.\n\n2.  **Dependencies**:\n    -   Add `serde` (with derive), `serde_json`, and `chrono` (with serde) to `crates/aoc-core/Cargo.toml`.\n\n3.  **Implement Data Models**:\n    -   **`src/task.rs`**: Define `Task` struct mirroring the schema used in `tasks.json` (ref Task #18). Fields: `id` (u32/usize), `title` (String), `description` (String), `status` (Enum: Pending, InProgress, Done, Cancelled), `priority` (Enum), `dependencies` (Vec<u32>), `created_at` (DateTime<Utc>).\n    -   **`src/context.rs`**: Define `Context` struct to formalize the data generated by the Context Watcher (ref Task #30). Fields: `file_path` (PathBuf), `last_updated` (DateTime<Utc>), `content_hash` (String), `raw_content` (String).\n    -   **`src/memory.rs`**: Define `Memory` and `MemoryEntry` structs to support future agent interactions. Fields: `role` (String), `content` (String), `timestamp` (DateTime<Utc>).\n\n4.  **Exports**:\n    -   Ensure these modules are public in `lib.rs`.",
        "testStrategy": "1. **Serialization Round-trip**: Create a unit test in `src/task.rs` that instantiates a `Task`, serializes it to JSON, and asserts the string matches the expected format used by the Taskmaster plugin.\n2. **Schema Compatibility**: Copy a real entry from `tasks.json` into a test string and verify `serde_json::from_str::<Task>` deserializes it correctly without error.",
        "status": "done",
        "dependencies": [
          "18",
          "30"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-21T19:41:32.370Z",
        "activeAgent": false
      },
      {
        "id": "37",
        "title": "Implement aoc-cli Binary with Task and Mem Subcommands",
        "description": "Develop a unified Rust CLI tool in `crates/aoc-cli` that consumes `aoc-core` to replace legacy shell scripts for task and memory management.",
        "details": "This task involves creating the primary user-facing binary for the Agent Ops Cockpit, centralizing logic currently scattered across shell scripts.\n\n### Implementation Requirements\n\n1.  **Crate Initialization**:\n    -   Create `crates/aoc-cli`.\n    -   Update workspace `Cargo.toml`.\n    -   Add dependencies: `clap` (with `derive`), `anyhow`, `serde`, `serde_json`, and the local `aoc-core` crate.\n\n2.  **CLI Architecture (`src/main.rs`)**:\n    -   Use `clap::Parser` to define the entry point.\n    -   Create an enum `SubCommand` with variants `Task` and `Mem`.\n\n3.  **Task Subcommand (`src/commands/task.rs`)**:\n    -   Implement generic task operations utilizing `aoc_core::Task` models.\n    -   **actions**: `list` (display table), `add <title>` (append to tasks.json), `done <id>` (toggle status).\n    -   Ensure IO parity with existing `plugins/taskmaster` logic regarding `tasks.json` locking/writing.\n\n4.  **Mem Subcommand (`src/commands/mem.rs`)**:\n    -   Implement interactions with the memory/context system using `aoc_core::Memory` models.\n    -   **actions**: `add <content>` (append to memory bank), `search <query>` (grep/filter functionality).\n\n5.  **Integration**:\n    -   Ensure the binary reads configuration (paths to tasks.json) from the environment or default locations consistent with the project root.",
        "testStrategy": "1. **Clap Argument Verification**: specific unit tests to ensure `aoc-cli task add 'foo'` and `aoc-cli mem add 'bar'` parse arguments correctly.\n2. **Integration Test**: Create a temporary directory with a dummy `tasks.json`. Run the compiled binary to add a task, then verify the file content using `serde_json` to ensure the structure matches `aoc-core` definitions.\n3. **Idempotency Check**: Verify that running `task list` does not modify the file.",
        "status": "done",
        "dependencies": [
          "36"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-21T19:47:55.887Z",
        "activeAgent": false
      },
      {
        "id": "38",
        "title": "Rewrite aoc-taskmaster Plugin with aoc-core and Ratatui",
        "description": "Refactor the Taskmaster Zellij plugin to utilize the shared aoc-core library for data models and implement a modernized TUI using Ratatui with mouse support and interactive tables.",
        "details": "This task involves a significant refactor of the existing `plugins/taskmaster` to align with the new workspace architecture and improve UX.\n\n### Implementation Requirements\n\n1.  **Dependency Updates**:\n    -   Modify `plugins/taskmaster/Cargo.toml` to add `aoc-core` (path: `../../crates/aoc-core`) and `ratatui` (latest version).\n    -   Remove redundant local data structures (e.g., `Task`, `Status`) and replace them with imports from `aoc_core::models`.\n\n2.  **Ratatui Integration**:\n    -   Implement a custom Backend or helper to render `ratatui` buffers to the Zellij plugin output (standard output/ANSI).\n    -   Create a `ui.rs` module that defines the layout constraints (header, main table, footer/help).\n\n3.  **Table Widget**:\n    -   Use `ratatui::widgets::Table` to display tasks.\n    -   **Columns**: ID, State (checkbox/icon), Priority (colored), Title.\n    -   Implement `TableState` management in the plugin state to handle row selection and persistent highlighting.\n\n4.  **Input Handling & Scrolling**:\n    -   Update the `update` loop to handle `Event::Mouse` in addition to `Event::Key`.\n    -   **Mouse**: Map `Mouse::ScrollUp`/`Down` to table selection movement. Map `Mouse::LeftClick` to selecting the row under the cursor (requires calculating row height/offset).\n    -   **Keyboard**: Maintain existing bindings (j/k, d, r) but route them through the new `TableState` logic.",
        "testStrategy": "1. **Compilation Check**: Verify the plugin compiles with the new `aoc-core` dependency and WASM target (`cargo build --target w32-wasi`).\n2. **Interactive UI Test**: Load the plugin in Zellij. Verify that:\n   - The task list renders as a formatted table.\n   - Scrolling via mouse wheel moves the selection highlight.\n   - Clicking a row selects it.\n   - Resizing the pane adjusts column widths dynamically.\n3. **Data Integrity**: Ensure tasks loaded from `tasks.json` via `aoc-core` display correctly (correct status icons and priority colors).",
        "status": "done",
        "dependencies": [
          "36"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-21T20:08:08.127Z",
        "activeAgent": false
      },
      {
        "id": "39",
        "title": "Integrate aoc Binary in Tooling and Upgrade Watcher to aoc-core",
        "description": "Update agent tool definitions and documentation to utilize the new Rust CLI, and refactor the context watcher service to directly consume the aoc-core library for performance.",
        "details": "This task bridges the gap between the legacy shell-script environment and the new Rust architecture by updating external interfaces and internal background services.\n\n### Implementation Requirements\n\n1. **Tool Definitions & Documentation**:\n   - Audit `AGENTS.md` and tool definition files (likely in `.aoc/tools/` or `prompts/`) for references to legacy scripts like `task_add.sh` or `mem_add.sh`.\n   - Replace these references with the new `aoc-task` CLI syntax (e.g., `aoc-task add ...`).\n   - Ensure parameter mapping in JSON schemas aligns with `aoc-cli` arguments defined in Task #37.\n\n2. **Refactor `aoc-watcher`**:\n   - Modify `crates/aoc-watcher/Cargo.toml` (created in Task #30) to add `aoc-core` as a local dependency.\n   - Remove ad-hoc file reading/concatenation logic from the watcher.\n   - Import and utilize `aoc_core::context` (from Task #36) to handle file scanning, ignoring patterns (git/contextignore), and context aggregation.\n   - Ensure the watcher leverages `aoc-core`'s efficient string handling to reduce overhead during rapid file changes.",
        "testStrategy": "1. **Tool Invocation Verification**: Manually execute a tool definition command (simulating an agent) and verify the `aoc` binary receives the correct arguments and successfully modifies the state (e.g., adds a task).\n2. **Watcher Integration Loop**: Start the refactored watcher. Modify a file ignored by `.contextignore` (verify no update). Modify a valid source file. Verify `context.md` updates immediately and matches the format expected by `aoc-core` unit tests.",
        "status": "done",
        "dependencies": [
          "30",
          "36",
          "37"
        ],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-03T15:36:38.879Z",
        "activeAgent": false
      },
      {
        "id": "40",
        "title": "Explore aoc-size wizard for user-defined pane presets",
        "description": "Investigate a guided sizing wizard that writes user-specific Zellij layout presets; feasibility is limited because in-session layout swapping may be unsupported and the feature may not be universally useful.",
        "details": "Prototype an aoc-size flow that edits ~/.config/zellij/layouts/aoc.local.kdl (or generates named layout files) with user-selected pane sizes (default, agent-expanded, tasks-minimized, yazi-expanded, right-column-expanded). Document that Zellij cannot resize via mouse drag and may not support interactive layout switching, so the wizard should be optional and may provide limited value depending on the users screen and workflow.",
        "testStrategy": "Manual: run the wizard, launch AOC, and confirm pane sizing matches user inputs on multiple screen sizes; validate that the feature degrades gracefully if layout switching is not possible.",
        "status": "done",
        "dependencies": [],
        "priority": "low",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-24T20:46:39.934Z",
        "activeAgent": false
      },
      {
        "id": "41",
        "title": "Implement Multi-Shell Terminal Support",
        "description": "Enable terminal panes to launch in the user's preferred shell (fish, zsh, powershell, nushell, etc.) while keeping internal AOC scripts as bash. This is the first step toward cross-platform support.",
        "details": "Currently AOC wraps all panes in 'bash -lc'. For terminal panes, we should use Zellij's native cwd directive and launch the user's $SHELL directly. Internal scripts remain bash for consistency.",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Modify aoc.kdl.template to use Zellij cwd directive",
            "description": "Replace bash -lc cd pattern with native cwd directive and direct shell invocation for terminal panes",
            "status": "pending",
            "dependencies": [],
            "priority": "",
            "subtasks": null,
            "testStrategy": "",
            "activeAgent": false,
            "details": ""
          },
          {
            "id": 2,
            "title": "Create bin/aoc-shell-detect utility",
            "description": "Shell detection module that identifies user shell type and returns appropriate init flags for bash, zsh, fish, powershell, nushell",
            "status": "pending",
            "dependencies": [],
            "details": "",
            "subtasks": null,
            "priority": "",
            "testStrategy": "",
            "activeAgent": false
          },
          {
            "id": 3,
            "title": "Update aoc-new-tab for shell-agnostic layout generation",
            "description": "Ensure dynamically generated tab layouts respect user shell preference via AOC_SHELL or SHELL",
            "status": "pending",
            "dependencies": [],
            "activeAgent": false,
            "priority": "",
            "testStrategy": "",
            "subtasks": null,
            "details": ""
          },
          {
            "id": 4,
            "title": "Add AOC_SHELL environment variable support",
            "description": "Document and implement AOC_SHELL override for explicit shell selection with fallback to SHELL",
            "status": "pending",
            "dependencies": [],
            "priority": "",
            "subtasks": null,
            "details": "",
            "activeAgent": false,
            "testStrategy": ""
          },
          {
            "id": 5,
            "title": "Test with fish, zsh, powershell, and nushell",
            "description": "Validate terminal pane behavior with each shell type, ensure rc files are sourced and interactive mode works",
            "status": "pending",
            "dependencies": [],
            "subtasks": null,
            "activeAgent": false,
            "priority": "",
            "details": "",
            "testStrategy": ""
          },
          {
            "id": 6,
            "title": "Document multi-shell support in README",
            "description": "Add section explaining shell support, AOC_SHELL override, and known limitations due to Zellij platform constraints",
            "status": "pending",
            "dependencies": [],
            "details": "",
            "subtasks": null,
            "testStrategy": "",
            "activeAgent": false,
            "priority": ""
          }
        ],
        "aocPrd": null,
        "updatedAt": "2026-01-27T16:20:29.969Z",
        "activeAgent": true
      },
      {
        "id": "42",
        "title": "Implement Custom Layout Selection",
        "description": "Allow users to select, persist, and use custom Zellij layouts",
        "details": "Enables 'ricing' and community layout sharing by making the layout system generic and persistent. Includes bin/aoc-layout tool and updates to tab generation.",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Create bin/aoc-layout CLI tool",
            "description": "List, select, and persist layout choice.",
            "status": "pending",
            "dependencies": [],
            "subtasks": null,
            "details": "",
            "priority": "",
            "testStrategy": "",
            "activeAgent": false
          },
          {
            "id": 2,
            "title": "Update bin/aoc-new-tab for generic layouts",
            "description": "Support --layout flag and generic variable substitution.",
            "status": "pending",
            "dependencies": [],
            "activeAgent": false,
            "priority": "",
            "subtasks": null,
            "details": "",
            "testStrategy": ""
          },
          {
            "id": 3,
            "title": "Update bin/aoc-launch for persistence",
            "description": "Read layout_default on startup.",
            "status": "pending",
            "dependencies": [],
            "subtasks": null,
            "testStrategy": "",
            "priority": "",
            "activeAgent": false,
            "details": ""
          },
          {
            "id": 4,
            "title": "Document Custom Layouts",
            "description": "Add guide for creating compatible KDL layouts.",
            "status": "pending",
            "dependencies": [],
            "details": "",
            "subtasks": null,
            "testStrategy": "",
            "activeAgent": false,
            "priority": ""
          }
        ],
        "aocPrd": null,
        "updatedAt": "2026-01-27T16:47:57.746Z",
        "activeAgent": true
      },
      {
        "id": "54",
        "title": "OSS readiness cleanup: remove local state, fix paths, add WSL docs, add code of conduct",
        "description": "",
        "details": "",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-01-31T13:47:35.678Z",
        "activeAgent": false
      },
      {
        "id": "75",
        "title": "Insert new AOC tabs adjacent to source tab",
        "description": "When running aoc inside Zellij with multiple tabs, place the new tab immediately after the current tab instead of appending at the far right.",
        "details": "Update tab creation flow to preserve intuitive tab locality. Likely touch bin/aoc-new-tab (and optionally bin/aoc-launch Zellij path) by computing focused tab index before creation, then repositioning the new tab left as needed. Keep fallback behavior if tab index detection fails.",
        "testStrategy": "Manual: in a session with 4+ tabs, run aoc from a middle tab and verify new tab appears directly to its right; verify behavior is unchanged when starting from last tab or when index detection fails.",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-17T13:54:09.871Z",
        "activeAgent": false
      },
      {
        "id": "133",
        "title": "Introduce agent-centric task reflections for task closure and handoffs",
        "description": "Add a structured reflection surface to completed tasks so directing developers and downstream agents can understand intent alignment, tradeoffs, outcomes, and follow-up context.",
        "details": "Design Taskmaster support for task reflections that are written at task completion and optimized for AOC's agent-only workflow. Reflections must preserve both (1) developer-intent context (why the task existed, what success meant) and (2) agent-execution context (what was delivered, key decisions, risks, and next steps). Scope includes schema definition, CLI/TUI authoring flow, storage and retrieval semantics, and guidance for concise high-signal reflections.",
        "testStrategy": "Validate end-to-end: reflection can be authored at completion, persisted, surfaced in task detail views, and consumed in follow-up tasks. Add tests for required/optional fields, backward compatibility with tasks lacking reflections, and search/filter retrieval for handoff workflows.",
        "status": "pending",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": {
          "path": ".taskmaster/docs/prds/task-133_agent-task-reflections_prd_rpg.md",
          "updatedAt": "2026-02-27T13:16:17.398Z",
          "version": 1
        },
        "updatedAt": "2026-02-27T13:16:17.398Z",
        "activeAgent": false
      }
    ]
  },
  "aoc/pi_cleanup": {
    "tasks": [
      {
        "id": "121",
        "title": "Define PI-first target architecture and migration contract",
        "description": "Write final directory contract: .aoc stays control-plane, .pi becomes canonical for PI agent assets. Define compatibility policy and deprecation timeline.",
        "details": "Deliverable: approved migration blueprint including invariants, ownership map, and rollback criteria.",
        "testStrategy": "Review against current repo layout and confirm no ambiguous ownership remains.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-25T14:59:20.327Z",
        "activeAgent": false
      },
      {
        "id": "122",
        "title": "Update aoc-init to seed PI-first structure deterministically",
        "description": "Ensure aoc-init creates .pi/settings.json, seeds .pi/prompts from canonical source, and enforces idempotent behavior.",
        "details": "Add clear logging + preserve-if-exists semantics for all PI files. Remove obsolete alias prompt seeding.",
        "testStrategy": "Run aoc-init in a fresh temp repo; assert required .pi files and idempotent re-run.",
        "status": "done",
        "dependencies": [
          "121"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-25T15:03:09.778Z",
        "activeAgent": false
      },
      {
        "id": "123",
        "title": "Move PI prompt templates to canonical PI-owned location",
        "description": "Make .pi/prompts canonical for PI prompt assets; keep transition shim from legacy template location during migration window.",
        "details": "Decide whether .aoc/prompts/pi stays as generated mirror or is retired. Ensure tm-cc prompt remains canonical once.",
        "testStrategy": "Verify prompt availability after aoc-init + existing-project upgrade path.",
        "status": "done",
        "dependencies": [
          "121",
          "122"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-25T15:13:33.622Z",
        "activeAgent": false
      },
      {
        "id": "124",
        "title": "Convert PI skills to PI-canonical definitions and simplify sync",
        "description": "Stop treating .aoc/skills as canonical for PI-only mode; define .pi/skills ownership and simplify aoc-skill behavior.",
        "details": "Remove unnecessary cross-agent branches; ensure skill validation still works with PI-only assumptions.",
        "testStrategy": "Validate skill discovery/sync in fresh and existing repos; ensure no broken symlinks remain.",
        "status": "done",
        "dependencies": [
          "121"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-25T15:21:51.387Z",
        "activeAgent": false
      },
      {
        "id": "125",
        "title": "Deprecate and remove non-PI agent scaffolding/docs",
        "description": "Remove stale OpenCode/Codex/Kimi-focused seeding paths and docs that conflict with PI-only architecture.",
        "details": "Keep migration notes and explicit deprecation changelog entries.",
        "testStrategy": "Search for legacy agent seed paths and verify docs consistently describe PI-only behavior.",
        "status": "done",
        "dependencies": [
          "121"
        ],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-25T15:31:59.062Z",
        "activeAgent": false
      },
      {
        "id": "126",
        "title": "Define compatibility window and auto-migration for existing repos",
        "description": "Implement upgrade logic that repairs missing PI files and optionally migrates legacy prompt/skill paths.",
        "details": "Support no-destructive migration with clear warnings and one-command repair via aoc-init.",
        "testStrategy": "Run migration on existing repos (including honk-land) and verify state converges without manual edits.",
        "status": "done",
        "dependencies": [
          "122",
          "123",
          "124",
          "125"
        ],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-25T15:35:52.363Z",
        "activeAgent": false
      },
      {
        "id": "127",
        "title": "Add end-to-end validation + smoke tests for PI-first init",
        "description": "Cover aoc-init, prompt availability, skill availability, and tm-cc workflow presence in tests.",
        "details": "Include deterministic checks for .pi/settings.json and prompt list.",
        "testStrategy": "Automated shell tests + CI checks in fresh temp repos.",
        "status": "done",
        "dependencies": [
          "122",
          "123",
          "124",
          "126"
        ],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-25T15:37:10.060Z",
        "activeAgent": false
      },
      {
        "id": "128",
        "title": "Publish PI-first migration notes and release checklist",
        "description": "Document final structure, rationale, and operator actions. Provide cleanup checklist and rollback notes.",
        "details": "Update README/docs/configuration/docs/agents and changelog.",
        "testStrategy": "Docs walk-through with a fresh user path from install -> aoc-init -> prompts/skills usable.",
        "status": "done",
        "dependencies": [
          "126",
          "127"
        ],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-25T15:39:05.924Z",
        "activeAgent": false
      },
      {
        "id": "130",
        "title": "Enforce PI-only agent surface across AOC",
        "description": "Remove or hard-disable non-PI agent runtime paths so AOC operates PI-only by default and by interface contract.",
        "details": "Lock down agent selection/launch/install/sync surfaces to PI + PI-R only, keep migration-safe behavior for existing repos, and update docs/tests/release notes.",
        "testStrategy": "Validate that only PI agents are selectable/launchable; non-PI wrappers fail with clear guidance; smoke tests and docs walkthrough pass.",
        "status": "done",
        "dependencies": [
          "128"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Define PI-only cutoff contract and migration guardrails",
            "description": "Document exact non-PI commands/features to remove, hard-disable, or leave as compatibility no-ops for one release window.",
            "status": "done",
            "dependencies": []
          },
          {
            "id": 2,
            "title": "Lock agent discovery/selection to PI and PI-R only",
            "description": "Update aoc-agent/aoc-agent-run and any selector UI surfaces so non-PI IDs are no longer offered or accepted.",
            "status": "done",
            "dependencies": [
              "1"
            ]
          },
          {
            "id": 3,
            "title": "Hard-disable non-PI launcher and installer entry points",
            "description": "Make codex/gemini/cc/oc/kimi/omo wrappers and installer routes exit with explicit PI-only deprecation guidance (or remove where safe).",
            "status": "done",
            "dependencies": [
              "2"
            ]
          },
          {
            "id": 4,
            "title": "Simplify skill sync and task flows for PI-only targets",
            "description": "Constrain aoc-skill and related task commands/docs to PI canonical target semantics; remove non-PI target assumptions from active paths.",
            "status": "done",
            "dependencies": [
              "2"
            ]
          },
          {
            "id": 5,
            "title": "Update docs/config/changelog to PI-only operator model",
            "description": "Remove non-PI quickstart references and document migration/rollback path for repos still using legacy non-PI commands.",
            "status": "done",
            "dependencies": [
              "3",
              "4"
            ]
          },
          {
            "id": 6,
            "title": "Add PI-only regression/smoke coverage",
            "description": "Add targeted tests proving non-PI paths are blocked and PI init/launch flows still pass on fresh + existing repos.",
            "status": "done",
            "dependencies": [
              "3",
              "4"
            ]
          },
          {
            "id": 7,
            "title": "Release readiness: compatibility closeout + rollout checklist",
            "description": "Finalize release notes, user-facing deprecation notice timing, and post-release verification checklist.",
            "status": "done",
            "dependencies": [
              "5",
              "6"
            ]
          },
          {
            "id": 8,
            "title": "Remove PI-only deprecation stubs and finalize README PI-only position",
            "description": "After compatibility closeout, remove temporary deprecation wrapper messaging from non-PI harness entrypoints and keep a concise README note that PI is the canonical and only supported agent direction for AOC.",
            "status": "done",
            "dependencies": [
              "7"
            ]
          }
        ],
        "aocPrd": null,
        "updatedAt": "2026-02-26T06:22:06.854Z",
        "activeAgent": false
      }
    ],
    "aocPrd": {
      "path": ".taskmaster/docs/prds/aoc_pi_cleanup_prd_rpg.md",
      "updatedAt": "2026-02-25T14:44:14.821Z",
      "version": 1
    }
  },
  "rtk": {
    "tasks": [
      {
        "id": "86",
        "title": "Implement AOC RTK adapter contract and policy baseline",
        "description": "Create an AOC-owned RTK integration contract with status/install/doctor/enable/disable semantics and config defaults.",
        "details": "",
        "testStrategy": "Unit tests for adapter command resolution and config parsing; smoke-test status/install flows with RTK present and absent.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": {
          "path": ".taskmaster/docs/prds/aoc-rtk_prd_rpg.md",
          "updatedAt": "2026-02-21T07:57:19.346Z",
          "version": 1
        },
        "updatedAt": "2026-02-21T12:02:35.503Z",
        "activeAgent": false
      },
      {
        "id": "87",
        "title": "Build agent-agnostic runtime routing in aoc-agent-wrap",
        "description": "Integrate RTK routing at shell/session layer so all AOC agents benefit without model-specific hooks.",
        "details": "",
        "testStrategy": "Integration tests for routed commands, fail-open fallback, and bypass mode in managed AOC sessions.",
        "status": "done",
        "dependencies": [
          "86"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-21T12:02:35.527Z",
        "activeAgent": false
      },
      {
        "id": "88",
        "title": "Add RTK setup and diagnostics flow to Alt+C aoc-control",
        "description": "Expose RTK status/install/enable/disable actions in the floating control pane for guided setup.",
        "details": "",
        "testStrategy": "UI action-path tests and command invocation checks for status/install toggles.",
        "status": "done",
        "dependencies": [
          "86"
        ],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-21T12:02:35.539Z",
        "activeAgent": false
      },
      {
        "id": "89",
        "title": "Extend aoc-init to seed and migrate RTK integration defaults",
        "description": "Ensure next aoc-init upgrades legacy repositories to RTK-capable AOC setup without destructive overwrites.",
        "details": "",
        "testStrategy": "Migration smoke tests on legacy AOC repos plus idempotency checks across repeated runs.",
        "status": "done",
        "dependencies": [
          "86"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-21T12:02:35.553Z",
        "activeAgent": false
      },
      {
        "id": "90",
        "title": "Document RTK operating modes, safety model, and rollout guidance",
        "description": "Publish operator docs for allowlist policy, fail-open behavior, bypass controls, and troubleshooting.",
        "details": "",
        "testStrategy": "Doc accuracy pass against shipped commands/config and quickstart validation in a clean environment.",
        "status": "done",
        "dependencies": [
          "87",
          "88",
          "89"
        ],
        "priority": "medium",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-21T12:02:35.570Z",
        "activeAgent": false
      }
    ]
  },
  "mermaid": {
    "tasks": [
      {
        "id": "76",
        "title": "Integrate Mermaid renderer with phased rollout",
        "description": "Plan and implement Mermaid renderer integration across Phase 1 optional binary support and Phase 2 embedded Rust path.",
        "details": "Create integration that starts with optional external mmdr binary, configurable output directory precedence, doctor/install checks, and graceful fallback; then add optional embedded renderer behind feature flags after Phase 1 validation.",
        "testStrategy": "Validate output-dir precedence, missing-binary fallback UX, install/doctor checks, feature-flag gating, rendering correctness, and regression smoke tests across session modes.",
        "status": "pending",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": {
          "path": ".taskmaster/docs/prds/76-integrate-mermaid-renderer-with-phased-rollout.md",
          "updatedAt": "2026-02-17T14:00:09.361Z",
          "version": 1
        },
        "updatedAt": "2026-02-17T14:00:09.361Z",
        "activeAgent": false
      }
    ]
  },
  "mind": {
    "tasks": [
      {
        "id": "101",
        "title": "Mind v1: deterministic contextualization architecture and contracts",
        "description": "Define and lock Mind v1 contracts for artifacts, attribution, routing, provider interfaces, and bounded context output.",
        "details": "Establish schema/version contracts and invariants for task-aware contextualization, including a deterministic T0 pre-distillation compaction stage. Define dual-lane guarantees: raw events remain append-only for provenance, while T0 compact events are deterministic derivatives used by T1/T2.\n\nT0 contract keeps user/assistant/system message text, strips bulky tool outputs by default, and preserves one-line tool metadata (tool name, success/fail, latency, exit code when present, output size, redaction flags). Support policy-versioned allowlist snippets for selected tools without breaking deterministic serialization.",
        "testStrategy": "Add schema contract fixtures and compatibility tests that enforce deterministic field sets, precedence rules, and stable serialization across reruns. Include T0 policy fixtures verifying tool outputs are stripped by default, metadata is retained, and allowlisted snippet behavior is deterministic for a fixed policy version.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-23T12:00:23.741Z",
        "activeAgent": false
      },
      {
        "id": "102",
        "title": "Implement aoc-storage Mind schema and migrations",
        "description": "Create SQLite schema and migration flow for Mind artifacts, task links, segment routes, and conversation context state.",
        "details": "Add tables for raw events, T0 compact events, observations, reflections, artifact-task links, segment routes, and attribution state, with indexes for retrieval by task, tag, segment, and recency. Persist policy/version metadata so T0 outputs are replayable and auditable against the compaction rule set used at ingest time.",
        "testStrategy": "Use migration and query tests against temp DBs; verify schema upgrades, index usage paths, and read/write correctness for key retrieval filters. Include replay tests proving raw->T0 derived artifacts are stable for the same policy version and that provenance links from T0 back to raw events remain intact.",
        "status": "done",
        "dependencies": [
          "101"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-23T12:00:23.763Z",
        "activeAgent": false
      },
      {
        "id": "103",
        "title": "Implement aoc-opencode-adapter incremental ingestion",
        "description": "Build resilient conversation ingestion with checkpoints and normalized event output for Mind processing.",
        "details": "Parse OpenCode stores incrementally, tolerate partial writes/corrupt records, and persist checkpoints to resume deterministically across restarts. In the same ingestion flow, materialize a T0 compact transcript lane from raw events using policy-driven filtering: keep user/assistant/system messages, strip bulky tool outputs, keep one-line tool metadata, and include optional allowlisted snippets.\n\nStore per-conversation checkpoint state for both raw offsets and T0 derivation progress so recovery is deterministic and idempotent.",
        "testStrategy": "Add golden fixture tests for known log shapes plus truncation/corruption and restart-resume integration tests. Include mixed-message fixtures validating T0 output rules (tool output stripped by default, metadata retained, allowlist snippets included only when configured) and deterministic recovery after mid-write restarts.",
        "status": "done",
        "dependencies": [
          "101"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-23T12:00:23.799Z",
        "activeAgent": false
      },
      {
        "id": "104",
        "title": "Capture Taskmaster signals and active tag context",
        "description": "Capture task/tag signals (including tm tag current --json) and persist per-conversation attribution state.",
        "details": "Track active tag snapshots and task lifecycle events so attribution can carry context forward across chunks and sessions.",
        "testStrategy": "Validate command/event parsing with fixtures and integration tests that confirm deterministic state carry-forward after process restarts.",
        "status": "done",
        "dependencies": [
          "102",
          "103"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-23T12:00:23.833Z",
        "activeAgent": false
      },
      {
        "id": "105",
        "title": "Implement artifact-task attribution and retroactive backfill",
        "description": "Link artifacts to one or more tasks with relation/confidence and backfill earlier chunks when late task evidence appears.",
        "details": "Support multi-task relationships per artifact (active/worked_on/mentioned/completed) and preserve provenance during confidence updates. Attribution should consume Taskmaster signal history plus compact conversation evidence from T0, including lightweight tool metadata where relevant, while avoiding dependence on bulky raw tool outputs.",
        "testStrategy": "Use long-chat fixtures with late task mentions and overlapping task windows to verify many-to-many links and deterministic backfill. Include cases where attribution evidence comes from T0 message content and tool metadata, ensuring confidence updates remain auditable and reproducible.",
        "status": "done",
        "dependencies": [
          "104"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-23T12:00:23.856Z",
        "activeAgent": false
      },
      {
        "id": "106",
        "title": "Implement Taskmaster-first segment routing with overrides",
        "description": "Route artifacts using tag-to-segment mapping first, then heuristics/semantic fallback with auditable confidence.",
        "details": "Store primary/secondary segments, routing reasons, and override patches; maintain global/uncertain fallback buckets for low-confidence events.",
        "testStrategy": "Add routing fixtures for clean, ambiguous, and override paths with regression checks on provenance and confidence scoring.",
        "status": "done",
        "dependencies": [
          "105"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-23T12:10:40.631Z",
        "activeAgent": false
      },
      {
        "id": "107",
        "title": "Build deterministic T1/T2 distillation runtime",
        "description": "Implement local deterministic observation/reflection passes with strict bounded outputs and reproducible behavior.",
        "details": "Distill raw events into tiered artifacts while preserving trace IDs and enforcing output budgets for downstream context composition. T1/T2 runtime should consume the T0 compact transcript lane by default (raw lane remains provenance source).\n\nParser policy: if a single conversation's T0 transcript fits parser budget (target <= 28k tokens, hard cap 32k), run one-conversation single-pass T1; never combine multiple conversations in one T1 pass. If over cap, chunk only within that same conversation and preserve deterministic chunk ordering and traceability.",
        "testStrategy": "Use mock-model and golden-output tests to verify deterministic distillation, bounded output, and traceability links. Add budget-policy fixtures that enforce no cross-conversation mixing, single-pass behavior when under cap, and deterministic intra-conversation chunking when over cap.",
        "status": "done",
        "dependencies": [
          "102",
          "103",
          "105"
        ],
        "priority": "high",
        "subtasks": [],
        "aocPrd": null,
        "updatedAt": "2026-02-23T14:09:52.430Z",
        "activeAgent": false
      },
      {
        "id": "108",
        "title": "Implement PI-native semantic OM runtime (session T1 observers + singleton T2 reflector) with guardrails",
        "description": "Run semantic Observer/Reflector inference through PI provider runtime with one background observer per active session, one detached singleton reflector, and deterministic fail-open fallback.",
        "details": "Implement semantic OM runtime using PI subprocess/provider infrastructure rather than external-first inference. Architecture: (1) per-session Observer sidecar for T1 with debounce + queueing, (2) singleton detached Reflector for T2 triggered by observation thresholds, (3) lock/lease coordination to prevent duplicate reflection writes across concurrent sessions, (4) strict timeout/token/cost/retry guardrails with deterministic fallback, and (5) persisted provenance/fallback metadata per artifact.",
        "testStrategy": "Validate with fixture and integration tests for multi-session observer concurrency, singleton reflector lock contention, stale-lease recovery, semantic output schema validation, deterministic fallback on provider failure, and policy invariants (no cross-conversation T1 mixing, deterministic chunk ordering, tag-bounded T2 aggregation).",
        "status": "done",
        "dependencies": [
          "107"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Define semantic runtime interfaces and canonical payload contracts",
            "description": "Finalize Observer/Reflector adapter contracts, canonical input hashing, strict output schemas, and deterministic compatibility boundaries for semantic_with_fallback mode.",
            "status": "done",
            "dependencies": []
          },
          {
            "id": 2,
            "title": "Implement session-scoped T1 Observer sidecar via PI runtime",
            "description": "Add per-session background observer execution (queue + debounce + single active run) that invokes semantic T1 through PI subprocess/provider config with bounded prompts.",
            "status": "done",
            "dependencies": [
              "1"
            ]
          },
          {
            "id": 3,
            "title": "Implement singleton detached T2 Reflector with lock/lease coordination",
            "description": "Build detached reflector worker triggered by T1 thresholds, with advisory lock + durable lease/job-claim behavior to prevent duplicate reflection passes across concurrent sessions.",
            "status": "done",
            "dependencies": [
              "1",
              "2"
            ]
          },
          {
            "id": 4,
            "title": "Add PI model profiles and runtime guardrails",
            "description": "Support configurable observer/reflector model profiles via PI providers, plus timeout/token/cost/retry controls and background scheduling limits.",
            "status": "done",
            "dependencies": [
              "2",
              "3"
            ]
          },
          {
            "id": 5,
            "title": "Implement fail-open deterministic fallback and provenance persistence",
            "description": "On semantic timeout/invalid output/budget failure, persist deterministic fallback artifacts and full runtime provenance (provider/model/hash/latency/fallback reason).",
            "status": "done",
            "dependencies": [
              "4"
            ]
          },
          {
            "id": 6,
            "title": "Ship fixture/integration suite for concurrency, locking, and fallback",
            "description": "Add multi-session fixtures and integration tests covering observer queueing, reflector lock contention + stale lease recovery, semantic schema rejection, deterministic fallback guarantees, and policy invariant regressions.",
            "status": "done",
            "dependencies": [
              "5"
            ]
          },
          {
            "id": 7,
            "title": "Add observer trigger hooks (manual/task complete/token threshold) and priority scheduling",
            "description": "Extend per-session observer sidecar with trigger kinds/priorities, debounce bypass for manual runs, and surfaced trigger metadata for UI/pane integration.",
            "status": "done",
            "dependencies": []
          }
        ],
        "aocPrd": {
          "path": ".taskmaster/docs/prds/task-108_semantic-om-background-layer_prd.md",
          "updatedAt": "2026-02-25T15:13:19.528Z",
          "version": 1
        },
        "updatedAt": "2026-02-26T06:31:12.752Z",
        "activeAgent": false
      },
      {
        "id": "109",
        "title": "Implement Mind v2 handoff/context-pack composer (T3 canon + session deltas)",
        "description": "Generate bounded context packs using precedence aoc-mem -> aoc-stm -> T3 handshake/canon -> session T2/T1 exports with active tag filtering.",
        "details": "Execution role: CRITICAL_PATH_CONTEXT_PACK. Compose deterministic one-screen handoffs and role-ready context payloads from project canon plus relevant session deltas. Support session start, tag switch, aoc-stm resume, mind_handoff, and specialist dispatch inputs. Include citation links to canon entries and source artifacts, with expandable detail mode for deeper historical recall.",
        "testStrategy": "Fixture and integration tests for precedence order, deterministic rendering, token budgets, tag filtering, citation traceability, and stable role-targeted slices across startup/resume/handoff scenarios.",
        "status": "pending",
        "dependencies": [
          "139",
          "136"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Define Mind v2 context-pack precedence and payload schema",
            "description": "Lock precedence contract across aoc-mem, aoc-stm, T3 handshake/canon, and session T2/T1 deltas with deterministic field schema.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 2,
            "title": "Implement context-pack compiler for startup, resume, handoff, and dispatch modes",
            "description": "Compile bounded payload variants by trigger context while preserving deterministic rendering and citation metadata.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 3,
            "title": "Implement budget profiles and expansion controls",
            "description": "Support one-screen default plus expandable detail mode with strict token/char envelopes per mode.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 4,
            "title": "Validate traceability and determinism of generated packs",
            "description": "Add fixture tests confirming stable hashes, citation chains, and tag-filter correctness across repeated runs.",
            "status": "pending",
            "dependencies": []
          }
        ],
        "aocPrd": null,
        "updatedAt": "2026-02-28T19:43:52.897Z",
        "activeAgent": false
      },
      {
        "id": "110",
        "title": "Finalize aoc-insight UX over Mind v2 session/project retrieval facets",
        "description": "Deliver user-facing aoc-insight query UX over Mind v2 retrieval scopes with bounded outputs and citation-first defaults.",
        "details": "Execution role: ROLLUP_CONSUMER_UX. Layer command UX, compatibility flags, and operator-facing output semantics on top of the Mind v2 retrieval core. Ensure brief/refs/snips and scope selection are coherent with project canon and session export drilldown behavior, while preserving deterministic local-first fallback.",
        "testStrategy": "Golden CLI tests for output shape and citations across session/project/auto scopes; compatibility tests for legacy flags; fallback tests for missing canon/exports and bounded-output enforcement.",
        "status": "pending",
        "dependencies": [
          "109",
          "141"
        ],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "Define aoc-insight command UX and scope semantics for Mind v2",
            "description": "Specify session/project/auto scope behavior, default ranking policy, and output-mode expectations.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 2,
            "title": "Implement retrieval-to-output pipeline for brief/refs/snips",
            "description": "Wire retrieval core to user-facing formatter with citation-first defaults and bounded payloads.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 3,
            "title": "Add compatibility behavior for legacy flags and workflows",
            "description": "Preserve expected behavior for existing usage patterns while routing through Mind v2 retrieval facets.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 4,
            "title": "Ship golden CLI regression suite for retrieval UX",
            "description": "Cover ranking stability, citation integrity, fallback messaging, and output budget enforcement.",
            "status": "pending",
            "dependencies": []
          }
        ],
        "aocPrd": null,
        "updatedAt": "2026-02-28T19:43:31.949Z",
        "activeAgent": false
      },
      {
        "id": "129",
        "title": "Implement PI specialist role interface (Scout, Planner, Builder, Reviewer, Documenter, Red Team) with human-in-command dispatch",
        "description": "Provide an explicit developer-in-control interface to invoke specialist agents on demand while using Mind v2 context packs and adaptive handshake context.",
        "details": "Execution role: ROLLUP_CONSUMER_SPECIALIST. Build a PI-first dispatch interface where specialist agents are called actively (not autonomously) and integrate Mind v2 context payloads sourced from T3 canon plus session deltas. Enforce explicit dispatch actions, role-scoped tool access, approval gates, and clear run telemetry/status in-session.",
        "testStrategy": "Manual and fixture-driven tests for role dispatch flows, approval-gate enforcement, role tool-scope restrictions, cancellation/retry behavior, deterministic transcript/provenance capture, and correctness of injected Mind v2 context slices.",
        "status": "pending",
        "dependencies": [
          "109",
          "139",
          "141"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Define role contracts and persona prompt templates",
            "description": "Define canonical intent, scope, constraints, inputs, outputs, and default model/tool profiles for Scout, Planner, Builder, Reviewer, Documenter, and Red Team agents.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 2,
            "title": "Implement PI dispatch interface for active role invocation",
            "description": "Add commands/tools to call specialist roles explicitly (no autonomous fan-out), with clear task payloads and bounded execution lifecycle.",
            "status": "pending",
            "dependencies": [
              "1"
            ]
          },
          {
            "id": 3,
            "title": "Enforce role-scoped tool policies and approval gates",
            "description": "Apply per-role tool allowlists and require explicit developer confirmation for write/destructive actions or policy escalations.",
            "status": "pending",
            "dependencies": [
              "2"
            ]
          },
          {
            "id": 4,
            "title": "Integrate role dispatch with Mind v2 context packs and handshake deltas",
            "description": "Feed deterministic context packs/handoffs into role invocations so specialists operate on current task/tag context with citations.",
            "status": "pending",
            "dependencies": [
              "2"
            ]
          },
          {
            "id": 5,
            "title": "Add operator telemetry UI for role runs",
            "description": "Surface active role, status, elapsed time, token/cost budget usage, and outcome summaries to keep developer control and observability high.",
            "status": "pending",
            "dependencies": [
              "2"
            ]
          },
          {
            "id": 6,
            "title": "Ship validation suite for role orchestration safety and quality",
            "description": "Test dispatch determinism, policy enforcement, refusal/escalation behavior, and role-output quality under realistic task scenarios.",
            "status": "pending",
            "dependencies": [
              "3",
              "4",
              "5"
            ]
          }
        ],
        "aocPrd": {
          "path": ".taskmaster/docs/prds/task-129_pi-specialist-role-interface_prd.md",
          "updatedAt": "2026-02-25T15:15:22.228Z",
          "version": 1
        },
        "updatedAt": "2026-02-28T19:43:31.959Z",
        "activeAgent": false
      },
      {
        "id": "131",
        "title": "Deliver dev-tab Mind feed cutover aligned to Mind v2 pipeline",
        "description": "Expose active-session observer state plus project T3/canon handshake indicators in the dev-tab Mind pane with trigger and runtime badges.",
        "details": "Execution role: ROLLUP_VIEW_DEVTAB. Cut over top-right pane to Mind v2 feed model showing session T0/T1/T2 activity plus T3 backlog/canon freshness and injection-trigger outcomes. Keep transitional compatibility toggle during rollout while routing state from canonical Mind v2 contracts.",
        "testStrategy": "UI integration tests for active-tab filtering, multi-stage status transitions, fallback/error badges, and trigger propagation; runtime tests for session + project indicator consistency.",
        "status": "pending",
        "dependencies": [
          "140"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Define Mind v2 feed contract for session and project indicators",
            "description": "Normalize SessionObserverRunOutcome into UI feed events with trigger/runtime/failure metadata.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 2,
            "title": "Implement top-right pane cutover with T0/T1/T2 activity and T3 badges",
            "description": "Render queued/running/completed/fallback cards filtered by active session/tab and conversation.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 3,
            "title": "Wire manual actions and injection-trigger updates into pane feed",
            "description": "Bind user shortcut to enqueue_manual and ensure task-complete trigger surfaces immediately in feed.",
            "status": "pending",
            "dependencies": []
          }
        ],
        "aocPrd": null,
        "updatedAt": "2026-02-28T19:43:31.979Z",
        "activeAgent": false
      },
      {
        "id": "132",
        "title": "Implement AOC Mind graph foundation for cross-session and T3 canon visualization",
        "description": "",
        "details": "Execution role: ROLLUP_VIEW_GRAPH. Create canonical graph payloads spanning conversation lineage, session exports, T3 backlog transitions, canon revisions, and handshake snapshots. Expose deterministic export interfaces and Mission Control adapter contracts for future graph pane rendering.",
        "testStrategy": "Add contract, storage, projection, and export tests with deterministic snapshots, lineage integrity checks, and graph coverage for session-to-T3-to-canon relationships.",
        "status": "pending",
        "dependencies": [
          "137",
          "138"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Define cross-session graph schema including T3 and canon revisions",
            "description": "Specify nodes, edges, diagnostics, and provenance fields for lineage + backlog + canon + handshake relationships.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 2,
            "title": "Implement graph projection builders from canonical storage",
            "description": "Materialize deterministic graph payloads from conversation lineage, exports, backlog jobs, and canon revisions.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 3,
            "title": "Implement deterministic graph exports and Mission Control adapter contract",
            "description": "Expose stable serialization and adapter APIs for future graph pane rendering.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 4,
            "title": "Add snapshot and integrity tests for graph projections",
            "description": "Validate deterministic output ordering, edge completeness, and lineage integrity edge cases.",
            "status": "pending",
            "dependencies": []
          }
        ],
        "aocPrd": {
          "path": ".taskmaster/docs/prds/aoc-mind-graph-foundation_prd_rpg.md",
          "updatedAt": "2026-02-26T08:49:26.278Z",
          "version": 1
        },
        "updatedAt": "2026-02-28T19:43:31.989Z",
        "activeAgent": false
      },
      {
        "id": "134",
        "title": "AOC Mind v2: Project-scoped T3 canon/backlog and adaptive handshake architecture",
        "description": "Define and implement the complete Mind v2 architecture: per-project canonical mind storage, session finalization into T3 backlog, project canon synthesis, and adaptive handshake injection.",
        "details": "Execution role: UMBRELLA_ROLLUP. Defines and governs the complete Mind v2 architecture, acceptance gates, and phase alignment. Establishes '.aoc/mind/' as project-scoped memory root, introduces T3 consolidation pipeline, and defines canonical handshake strategy (startup baseline + event-driven bounded refresh). Reuse useful existing T0/T1/T2 code, but prioritize correctness of end-state architecture over backward compatibility with intermediate wiring.",
        "testStrategy": "Architecture acceptance: (1) finalized sessions enqueue deterministic T3 jobs, (2) T3 updates project canon with revision/supersede lifecycle, (3) handshake remains bounded and hash-deduped, (4) observability covers T0/T1/T2/T3 states end-to-end.",
        "status": "pending",
        "dependencies": [
          "108"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Finalize Mind v2 architecture contracts and invariants",
            "description": "Lock canonical contracts for T0/T1/T2/T3 scopes, project storage root, lifecycle triggers, and injection policy invariants.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 2,
            "title": "Align existing pending mind tasks to Mind v2 phase model",
            "description": "Map legacy pending tasks to Mind v2 phases and identify explicit keep/replace decisions.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 3,
            "title": "Define architecture acceptance gate for cutover readiness",
            "description": "Document objective architecture-level acceptance checks required before rollout approval.",
            "status": "pending",
            "dependencies": []
          }
        ],
        "aocPrd": {
          "path": ".taskmaster/docs/prds/aoc-mind-v2_t3-project-canon_prd_rpg.md",
          "updatedAt": "2026-02-28T19:28:31.236Z",
          "version": 1
        },
        "updatedAt": "2026-02-28T19:43:31.864Z",
        "activeAgent": false
      },
      {
        "id": "135",
        "title": "Cut over AOC Mind storage to project-scoped canonical root and schema v2",
        "description": "Replace pane-local default mind storage with project-scoped canonical '.aoc/mind/' store contract, including new T3/canon/handshake tables and path resolution rules.",
        "details": "Execution role: CRITICAL_PATH_FOUNDATION. Replace pane-local default mind storage with project-scoped canonical '.aoc/mind/' store contract, including new T3/canon/handshake tables and path resolution rules. Implement storage migration plan and runtime path changes so all sessions in the same project contribute to one canonical project mind while preserving lineage and deterministic IDs. Include migration guards, path overrides, and compatibility handling for legacy pane-local stores.",
        "testStrategy": "Migration tests for fresh+upgrade DBs; path resolution tests for env overrides and defaults; regression tests confirming existing T0/T1/T2 writes remain valid under new project-scoped layout.",
        "status": "done",
        "dependencies": [
          "134"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Add schema migrations for T3 backlog, canon, handshake, and watermarks",
            "description": "Create migration set introducing canonical project-level persistence for backlog, canon revisions, handshake snapshots, and processing watermarks.",
            "status": "done",
            "dependencies": []
          },
          {
            "id": 2,
            "title": "Implement project-level mind path resolver and lock path policy",
            "description": "Resolve .aoc/mind canonical paths from project root with environment override support and deterministic defaults.",
            "status": "done",
            "dependencies": []
          },
          {
            "id": 3,
            "title": "Implement compatibility reader for legacy pane-local stores",
            "description": "Provide read/import bridge so historical artifacts can be migrated into project-level canonical storage.",
            "status": "done",
            "dependencies": []
          },
          {
            "id": 4,
            "title": "Ship migration verification tests and data integrity checks",
            "description": "Verify migration correctness for fresh/upgrade paths and ensure no artifact/provenance corruption.",
            "status": "done",
            "dependencies": []
          }
        ],
        "aocPrd": null,
        "updatedAt": "2026-02-28T20:05:29.686Z",
        "activeAgent": false
      },
      {
        "id": "136",
        "title": "Implement session finalization drain and deterministic T1/T2 export bundles",
        "description": "When sessions become inactive or shut down, drain pending observer/reflection work and emit deterministic export bundles under '.aoc/mind/insight/<session>_<datetime>/' with manifest metadata.",
        "details": "Execution role: CRITICAL_PATH_FINALIZATION. On inactivity/shutdown, drain pending observer/reflection work and emit deterministic export bundles under '.aoc/mind/insight/<session>_<datetime>/'. Add lifecycle triggers (idle timeout + shutdown + explicit finalize), bounded drain behavior, export writer for t1.md/t2.md/manifest.json, and idempotent finalize semantics. Finalization must enqueue T3 jobs using stable slice IDs/watermarks.",
        "testStrategy": "Lifecycle integration tests for idle/shutdown/manual finalize; idempotency tests for repeated finalize calls; export snapshot tests for deterministic file contents and manifests.",
        "status": "in-progress",
        "dependencies": [
          "135"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Detect session inactivity and shutdown finalize triggers",
            "description": "Add reliable trigger paths for idle timeout, graceful shutdown, and explicit finalize command.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 2,
            "title": "Drain pending observer and reflector work before export",
            "description": "Bounded finalization drain to flush queued T1/T2 work or mark deterministic fallback outcomes before export.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 3,
            "title": "Write deterministic session export bundle files",
            "description": "Emit insight/<session>_<datetime>/t1.md, t2.md, and manifest metadata with stable ordering and IDs.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 4,
            "title": "Enqueue idempotent T3 delta jobs from finalized session slices",
            "description": "Generate stable job key and watermark boundaries to avoid duplicate consolidation.",
            "status": "pending",
            "dependencies": []
          }
        ],
        "aocPrd": null,
        "updatedAt": "2026-02-28T20:05:51.989Z",
        "activeAgent": false
      },
      {
        "id": "137",
        "title": "Implement T3 backlog runtime (queue, singleton worker, lock/lease, watermarks)",
        "description": "Build project-level T3 backlog processing with robust job lifecycle, singleton coordination, delta-only processing, and exactly-once logical semantics via watermarks.",
        "details": "Execution role: CRITICAL_PATH_T3_RUNTIME. Build project-level T3 backlog processing with robust job lifecycle, singleton coordination, delta-only processing, and exactly-once logical semantics via watermarks. Add queue APIs, claim/complete/fail transitions, file lock + durable lease coordination, stale-owner takeover, and retry/requeue policies.",
        "testStrategy": "Concurrency tests for lock contention and stale lease takeover; replay/idempotency tests for duplicate enqueue and worker restart; failure-path tests for retry/requeue/dead-letter behavior.",
        "status": "pending",
        "dependencies": [
          "135",
          "136"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Implement T3 backlog job lifecycle APIs",
            "description": "Add enqueue, claim, heartbeat, complete, fail, and requeue operations with durable statuses.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 2,
            "title": "Implement singleton T3 worker coordination with lock and lease",
            "description": "Use advisory file lock plus DB lease semantics to ensure single project consolidator ownership.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 3,
            "title": "Implement watermark advancement and exactly-once logical replay safety",
            "description": "Process deltas deterministically and prevent duplicate canon application across retries/restarts.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 4,
            "title": "Add backlog runtime telemetry and failure diagnostics",
            "description": "Expose queue depth, lock conflicts, retries, and failure reasons for operator visibility.",
            "status": "pending",
            "dependencies": []
          }
        ],
        "aocPrd": null,
        "updatedAt": "2026-02-28T19:43:31.899Z",
        "activeAgent": false
      },
      {
        "id": "138",
        "title": "Implement T3 canon compiler with temporal revision lifecycle and project_mind export",
        "description": "Compile cross-session project canon from T3 deltas with confidence/freshness scoring, revision/supersede/stale lifecycle, and deterministic 'project_mind.md' export.",
        "details": "Execution role: CRITICAL_PATH_CANON. Compile cross-session project canon from T3 deltas with confidence/freshness scoring, revision/supersede/stale lifecycle, and deterministic 'project_mind.md' export. Maintain evidence references to T1/T2 artifacts and auditable lineage for each canonical update.",
        "testStrategy": "Golden tests for canon synthesis and deterministic ordering; lifecycle tests for supersede/stale transitions; provenance integrity tests linking canon entries back to source artifacts.",
        "status": "pending",
        "dependencies": [
          "137"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Implement canon synthesis model with confidence and freshness scoring",
            "description": "Compile cross-session evidence into concise project-level canon entries with explicit scoring metadata.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 2,
            "title": "Implement canon revision lifecycle states and supersede links",
            "description": "Track active, superseded, and stale entries with explicit lineage pointers.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 3,
            "title": "Export deterministic project_mind markdown snapshots",
            "description": "Render canon into stable human-readable markdown with anchors and citations.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 4,
            "title": "Validate canon provenance chain integrity",
            "description": "Ensure every canon statement can trace back to T1/T2 artifact evidence and source metadata.",
            "status": "pending",
            "dependencies": []
          }
        ],
        "aocPrd": null,
        "updatedAt": "2026-02-28T19:43:31.909Z",
        "activeAgent": false
      },
      {
        "id": "139",
        "title": "Implement handshake compiler and adaptive injection controller for startup/tag/resume/handoff",
        "description": "Build bounded handshake snapshots from T3 canon and apply adaptive turn-boundary injection policy for session start, tag switch, aoc-stm resume, and handoff triggers.",
        "details": "Execution role: CRITICAL_PATH_INJECTION. Build bounded handshake snapshots from T3 canon and apply adaptive turn-boundary injection policy for session start, tag switch, aoc-stm resume, and handoff triggers. Implement layered payload policy (project baseline + tactical delta), hash dedupe, cooldown windows, and context-pressure gating via runtime/extension hooks.",
        "testStrategy": "Policy tests for trigger matrix and budget gates; dedupe/cooldown tests across consecutive turns; integration tests for before_agent_start/context hook behavior and no mid-stream injection disruption.",
        "status": "pending",
        "dependencies": [
          "138"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Implement bounded handshake compiler from active canon",
            "description": "Build token-bounded baseline handshake snapshot and stable payload hash/version metadata.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 2,
            "title": "Implement injection trigger adapters for startup tag-switch resume and handoff",
            "description": "Translate runtime events into pending injection refresh actions applied on turn boundaries.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 3,
            "title": "Implement dedupe cooldown and context-pressure gates",
            "description": "Suppress redundant or high-pressure injections using hash checks, cooldown windows, and usage thresholds.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 4,
            "title": "Wire extension/runtime hooks for adaptive injection",
            "description": "Integrate before_agent_start and context hooks with pulse/runtime trigger events and policy decisions.",
            "status": "pending",
            "dependencies": []
          }
        ],
        "aocPrd": null,
        "updatedAt": "2026-02-28T19:43:31.919Z",
        "activeAgent": false
      },
      {
        "id": "140",
        "title": "Build Mind/Insight interactive backlog UX for T0/T1/T2/T3 observability and controls",
        "description": "Expose full pipeline state in Mind/Insight UI with per-session and project lanes, artifact drilldown, provenance tracing, and safe operator actions.",
        "details": "Execution role: ROLLUP_OBSERVABILITY. Expose full pipeline state in Mind/Insight UI with per-session and project lanes, artifact drilldown, provenance tracing, and safe operator actions. Include requeue T3, handshake rebuild, and force-finalize controls with auditable metadata.",
        "testStrategy": "UI integration tests for state transitions and filtering; runtime integration for action wiring and command results; regression tests for fallback/error badges and provenance rendering.",
        "status": "pending",
        "dependencies": [
          "137",
          "138"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Build Mind panel lanes for T0 T1 T2 and T3 pipeline state",
            "description": "Render stage-specific status lanes with filters by session, tag, and project.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 2,
            "title": "Implement artifact drilldown with provenance navigation",
            "description": "Allow operators to inspect artifacts and trace handshake to canon to source evidence.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 3,
            "title": "Add operator actions for requeue rebuild and force-finalize",
            "description": "Expose safe commands to requeue T3 jobs, rebuild handshake, and force session finalization.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 4,
            "title": "Add UI integration coverage for state transitions and controls",
            "description": "Cover queued, running, success, fallback, and error transitions with action wiring validation.",
            "status": "pending",
            "dependencies": []
          }
        ],
        "aocPrd": null,
        "updatedAt": "2026-02-28T19:43:31.969Z",
        "activeAgent": false
      },
      {
        "id": "141",
        "title": "Extend aoc-insight retrieval across session exports and project canon",
        "description": "Upgrade retrieval to query both detailed per-session T1/T2 exports and T3 canonical project memory with bounded outputs and citations.",
        "details": "Execution role: CRITICAL_PATH_RETRIEVAL_CORE. Upgrade retrieval to query both detailed per-session T1/T2 exports and T3 canonical project memory with bounded outputs and citations. Support scopes ('session', 'project', 'auto'), citation-first output, and drilldown paths from handshake/canon entries to source session artifacts. Keep local artifacts authoritative and deterministic fallback intact.",
        "testStrategy": "Golden retrieval tests for ranking/citations across scopes; fallback tests for missing exports/canon; output-budget tests for brief/refs/snips modes.",
        "status": "pending",
        "dependencies": [
          "136",
          "138"
        ],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "Add retrieval scope planner for session project and auto modes",
            "description": "Select retrieval corpora based on requested scope and active context.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 2,
            "title": "Implement citation-first ranking across exports and canon",
            "description": "Return ranked results with traceable citations to canon entries and session artifacts.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 3,
            "title": "Extend output modes and payload budgets for deep drilldown",
            "description": "Support brief refs snips formats with deterministic size bounds.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 4,
            "title": "Add golden tests for ranking citations and fallback behavior",
            "description": "Validate output stability and graceful degradation when optional corpora are unavailable.",
            "status": "pending",
            "dependencies": []
          }
        ],
        "aocPrd": null,
        "updatedAt": "2026-02-28T19:43:31.929Z",
        "activeAgent": false
      },
      {
        "id": "142",
        "title": "Ship Mind v2 hardening, migration, and rollout validation suite",
        "description": "Deliver end-to-end reliability, performance, and migration validation for Mind v2 cutover to project-scoped T3 canon/backlog/handshake architecture.",
        "details": "Execution role: RELEASE_GATE_ROLLUP. Deliver end-to-end reliability, performance, and migration validation for Mind v2 cutover to project-scoped T3 canon/backlog/handshake architecture. Validate multi-session concurrency, crash recovery, lock/lease correctness, replay idempotency, and injection token budgets; produce rollout checklist and migration runbook.",
        "testStrategy": "E2E stress tests with concurrent sessions and forced crashes; long-run soak tests for backlog drain and handshake stability; migration verification tests and rollback safety checks.",
        "status": "pending",
        "dependencies": [
          "109",
          "110",
          "131",
          "132",
          "139",
          "140",
          "141"
        ],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Build concurrency and crash-recovery stress suite",
            "description": "Simulate multi-session churn, worker crashes, lock conflicts, and replay to verify deterministic recovery.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 2,
            "title": "Implement migration and rollback tooling with verification reports",
            "description": "Provide operator tooling to migrate legacy stores, validate integrity, and rollback safely if needed.",
            "status": "pending",
            "dependencies": []
          },
          {
            "id": 3,
            "title": "Publish rollout runbook and SLO instrumentation for Mind v2",
            "description": "Define staged rollout procedure, observability checks, and pass/fail gates for production adoption.",
            "status": "pending",
            "dependencies": []
          }
        ],
        "aocPrd": null,
        "updatedAt": "2026-02-28T19:43:52.908Z",
        "activeAgent": false
      }
    ],
    "aocPrd": {
      "path": ".taskmaster/docs/prds/aoc-mind_prd.md",
      "updatedAt": "2026-02-23T10:29:59.919Z",
      "version": 1
    }
  }
}