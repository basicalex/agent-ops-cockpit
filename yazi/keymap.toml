[mgr]
prepend_keymap = [
  # AOC integrations
  { on = ["W"], run = "shell --block 'aoc-widget-set \"$@\"'", desc = "Set widget media path" },
  { on = ["p"], run = "shell --block 'aoc-preview-set \"$@\"'", desc = "Send to floating preview" },
  { on = ["P"], run = "shell --block 'aoc-preview-toggle'", desc = "Toggle floating preview" },
  { on = ["<C-p>"], run = "plugin aoc-preview-toggle", desc = "Toggle inline preview" },

  # Navigation
  { on = ["g", "c"], run = "cd .aoc", desc = "Go to Context" },
  { on = ["g", "m"], run = "shell --block 'zellij action resize increase right && zellij action resize increase right && zellij action resize increase right && zellij action resize increase right && zellij action resize increase right && zellij action resize increase right && zellij action resize increase right && zellij action resize increase right && zellij action resize increase right && zellij action resize increase right && zellij action resize increase right && zellij action resize increase right && ${EDITOR:-micro} .aoc/memory.md; zellij action resize decrease right && zellij action resize decrease right && zellij action resize decrease right && zellij action resize decrease right && zellij action resize decrease right && zellij action resize decrease right && zellij action resize decrease right && zellij action resize decrease right && zellij action resize decrease right && zellij action resize decrease right && zellij action resize decrease right'", desc = "Edit Memory" },
  { on = ["g", "s"], run = "shell --block 'aoc-stm edit'", desc = "Edit STM" },
  { on = ["g", "S"], run = "cd .aoc/stm", desc = "Go to STM" },
  { on = ["g", "t"], run = "cd .taskmaster", desc = "Go to Tasks" },
  { on = ["g", "l"], run = "shell 'cd \"${XDG_STATE_HOME:-$HOME/.local/state}/aoc\" && yazi'", desc = "Go to Logs" },

  # SMART OPEN (Enter / o)
  { on = ["<Enter>"], run = "plugin aoc-open", desc = "Smart Open" },
  { on = ["o"], run = "plugin aoc-open", desc = "Smart Open (Yazi o)" },
  { on = ["<S-Enter>"], run = "plugin aoc-open-explorer", desc = "Open in Explorer" },

  # Pane Expansion
  { on = ["e"], run = "plugin aoc-pane-toggle", desc = "Toggle Full Yazi mode" },

  # Global Overrides
  { on = ["?"], run = "plugin aoc-help-toggle", desc = "Help" },
  { on = ["q"], run = "noop", desc = "Disabled" },

  # Quick navigation
  { on = ["<Esc>"], run = "escape", desc = "Cancel/escape" },
]

[help]
prepend_keymap = [
  { on = ["<Esc>"], run = "plugin aoc-help-exit", desc = "Close help" },
]
