layout {
  tab name="__AOC_TAB_NAME__" focus=true {
    pane split_direction="horizontal" {
      pane size=1 borderless=true {
        plugin location="file:/home/ceii/.config/zellij/plugins/zjstatus.wasm" {
          format_left   "{mode} #[fg=#89B4FA,bold]{session}"
          format_center "{tabs}"
          format_right  "{command_cwd}"
          format_space  ""

          border_enabled  "false"
          border_char     "─"
          border_format   "#[fg=#6C7086]{char}"
          border_position "bottom"

          hide_frame_for_single_pane "true"

          mode_normal  "#[bg=blue] "
          mode_tmux    "#[bg=#ffc387] "

          tab_normal   "#[fg=#6C7086] {name} "
          tab_active   "#[fg=#9399B2,bold,italic] {name} "

          command_cwd_command  "pwd | sed 's|.*/||'"
          command_cwd_format   "#[fg=#6C7086] {stdout} "
          command_cwd_interval "2"
        }
      }
      pane split_direction="vertical" {
        // LEFT: Yazi (tree + preview). Starts in project root.
        pane size="13%" name="Yazi" command="bash" {
          args "-lc" "export EDITOR=/home/ceii/dev/agent-ops-cockpit/bin/micro; export VISUAL=$EDITOR; root_file=\"__AOC_PROJECT_ROOT_FILE__\"; root=\"__AOC_PROJECT_ROOT__\"; if [[ -f \"$root_file\" ]]; then root=\"$(cat \"$root_file\")\"; fi; cd \"$root\" && exec ${AOC_FILETREE_CMD:-yazi} ."
        }

        // CENTER + RIGHT COLUMN
        pane split_direction="vertical" {

          // CENTER stack: Codex (top) + Taskmaster (bottom)
          pane split_direction="horizontal" {
            pane size="70%" name="Agent [__AOC_AGENT_ID__]" command="bash" {
              args "-lc" "root_file=\"__AOC_PROJECT_ROOT_FILE__\"; root=\"__AOC_PROJECT_ROOT__\"; if [[ -f \"$root_file\" ]]; then root=\"$(cat \"$root_file\")\"; fi; cd \"$root\" && AOC_AGENT_RUN=1 exec ${AOC_AGENT_CMD:-${AOC_CODEX_CMD:-aoc-agent-run}}"
            }

            pane size="30%" name="Tasks" {

              plugin location="file:/home/ceii/.config/zellij/plugins/aoc-taskmaster.wasm" {
                refresh_secs "5"
              }
            }
          }

          // RIGHT COLUMN: Widget (top), Clock (center), Terminal (bottom)
          pane size="23%" split_direction="horizontal" {
            pane size="34%" name="Widget" command="bash" {
              args "-lc" "root_file=\"__AOC_PROJECT_ROOT_FILE__\"; root=\"__AOC_PROJECT_ROOT__\"; if [[ -f \"$root_file\" ]]; then root=\"$(cat \"$root_file\")\"; fi; cd \"$root\" && exec ${AOC_WIDGET_CMD:-aoc-widget}"
            }
            pane size="18%" name="Clock" command="bash" {
              args "-lc" "AOC_CLOCK_IN_PANE=1 exec ${AOC_CLOCK_CMD:-aoc-clock}"
            }
            pane size="48%" command="bash" {
              args "-lc" "root_file=\"__AOC_PROJECT_ROOT_FILE__\"; root=\"__AOC_PROJECT_ROOT__\"; if [[ -f \"$root_file\" ]]; then root=\"$(cat \"$root_file\")\"; fi; cd \"$root\" && exec ${AOC_TERMINAL_CMD:-$SHELL}"
            }
          }
        }
      }
      pane size=1 borderless=true {
        plugin location="file:/home/ceii/.config/zellij/plugins/zjstatus.wasm" {
          format_left   "{mode}"
          format_center ""
          format_right  "{command_alt}"
          format_space  ""

          border_enabled  "false"
          border_char     "─"
          border_format   "#[fg=#6C7086]{char}"
          border_position "top"

          hide_frame_for_single_pane "true"

          mode_normal "#[fg=#89B4FA,bold]NORMAL #[fg=#6C7086]| #[fg=#A6E3A1]Ctrl #[fg=#6C7086]g Lock  p Pane  t Tab  n Resize  s Scroll  h Move  o Session  b Tmux"
          mode_locked "#[fg=#F38BA8,bold]LOCKED #[fg=#6C7086]| #[fg=#A6E3A1]Ctrl #[fg=#6C7086]g Unlock"
          mode_resize "#[fg=#FAB387,bold]RESIZE #[fg=#6C7086]| #[fg=#A6E3A1]h/j/k/l #[fg=#6C7086]Resize #[fg=#A6E3A1]H/J/K/L #[fg=#6C7086]Fine #[fg=#A6E3A1]+/- #[fg=#6C7086]Resize #[fg=#A6E3A1]Ctrl #[fg=#6C7086]n Normal"
          mode_pane "#[fg=#A6E3A1,bold]PANE #[fg=#6C7086]| #[fg=#A6E3A1]h/j/k/l #[fg=#6C7086]Move #[fg=#A6E3A1]n #[fg=#6C7086]New #[fg=#A6E3A1]d #[fg=#6C7086]Down #[fg=#A6E3A1]r #[fg=#6C7086]Right #[fg=#A6E3A1]x #[fg=#6C7086]Close #[fg=#A6E3A1]f #[fg=#6C7086]Fullscreen #[fg=#A6E3A1]w #[fg=#6C7086]Float #[fg=#A6E3A1]Ctrl #[fg=#6C7086]p Normal"
          mode_tab "#[fg=#94E2D5,bold]TAB #[fg=#6C7086]| #[fg=#A6E3A1]h/l #[fg=#6C7086]Prev/Next #[fg=#A6E3A1]n #[fg=#6C7086]New #[fg=#A6E3A1]x #[fg=#6C7086]Close #[fg=#A6E3A1]r #[fg=#6C7086]Rename #[fg=#A6E3A1]1-9 #[fg=#6C7086]Go #[fg=#A6E3A1]Ctrl #[fg=#6C7086]t Normal"
          mode_scroll "#[fg=#F9E2AF,bold]SCROLL #[fg=#6C7086]| #[fg=#A6E3A1]j/k #[fg=#6C7086]Scroll #[fg=#A6E3A1]Ctrl #[fg=#6C7086]f/b Page  c Bottom  s Normal #[fg=#A6E3A1]d/u #[fg=#6C7086]Half #[fg=#A6E3A1]s #[fg=#6C7086]Search #[fg=#A6E3A1]e #[fg=#6C7086]Edit"
          mode_enter_search "#[fg=#F9E2AF,bold]SEARCH #[fg=#6C7086]| #[fg=#A6E3A1]Enter #[fg=#6C7086]Find #[fg=#A6E3A1]Esc/Ctrl #[fg=#6C7086]c Back"
          mode_search "#[fg=#F9E2AF,bold]SEARCH #[fg=#6C7086]| #[fg=#A6E3A1]n/p #[fg=#6C7086]Next/Prev #[fg=#A6E3A1]c #[fg=#6C7086]Case #[fg=#A6E3A1]w #[fg=#6C7086]Wrap #[fg=#A6E3A1]o #[fg=#6C7086]Word #[fg=#A6E3A1]Ctrl #[fg=#6C7086]c Normal"
          mode_rename_tab "#[fg=#CBA6F7,bold]RENAME TAB #[fg=#6C7086]| #[fg=#A6E3A1]Enter #[fg=#6C7086]Save #[fg=#A6E3A1]Esc #[fg=#6C7086]Cancel"
          mode_rename_pane "#[fg=#CBA6F7,bold]RENAME PANE #[fg=#6C7086]| #[fg=#A6E3A1]Enter #[fg=#6C7086]Save #[fg=#A6E3A1]Esc #[fg=#6C7086]Cancel"
          mode_session "#[fg=#89B4FA,bold]SESSION #[fg=#6C7086]| #[fg=#A6E3A1]w #[fg=#6C7086]Manager #[fg=#A6E3A1]c #[fg=#6C7086]Config #[fg=#A6E3A1]p #[fg=#6C7086]Plugins #[fg=#A6E3A1]d #[fg=#6C7086]Detach #[fg=#A6E3A1]Ctrl #[fg=#6C7086]o Normal"
          mode_move "#[fg=#89B4FA,bold]MOVE #[fg=#6C7086]| #[fg=#A6E3A1]h/j/k/l #[fg=#6C7086]Move #[fg=#A6E3A1]n/Tab #[fg=#6C7086]Next #[fg=#A6E3A1]p #[fg=#6C7086]Prev #[fg=#A6E3A1]Ctrl #[fg=#6C7086]h Normal"
          mode_tmux "#[fg=#F38BA8,bold]TMUX #[fg=#6C7086]| #[fg=#A6E3A1]Ctrl #[fg=#6C7086]b Prefix  % Split R  \" Split D  z Fullscreen  c New Tab  p/n Prev/Next  b Normal"

          command_alt_command  "printf 'Alt f Float  n NewPane  i Tab<  o Tab>  h/j/k/l Focus  =/- Resize'"
          command_alt_format   "#[fg=#A6E3A1]{stdout} "
          command_alt_interval "60"
        }
      }
    }
  }
}
swap_layouts {
  layout {
    tab name="__AOC_TAB_NAME__" focus=true {
      pane split_direction="vertical" {
        // LEFT: Yazi (tree + preview). Starts in project root.
        pane size="10%" name="Yazi" command="bash" {
          args "-lc" "export EDITOR=/home/ceii/dev/agent-ops-cockpit/bin/micro; export VISUAL=$EDITOR; root_file=\"__AOC_PROJECT_ROOT_FILE__\"; root=\"__AOC_PROJECT_ROOT__\"; if [[ -f \"$root_file\" ]]; then root=\"$(cat \"$root_file\")\"; fi; cd \"$root\" && exec ${AOC_FILETREE_CMD:-yazi} ."
        }

        // CENTER + RIGHT COLUMN
        pane split_direction="vertical" {

          // CENTER stack: Codex (top) + Taskmaster (bottom)
          pane split_direction="horizontal" {
            pane size="62%" name="Agent [__AOC_AGENT_ID__]" command="bash" {
              args "-lc" "root_file=\"__AOC_PROJECT_ROOT_FILE__\"; root=\"__AOC_PROJECT_ROOT__\"; if [[ -f \"$root_file\" ]]; then root=\"$(cat \"$root_file\")\"; fi; cd \"$root\" && AOC_AGENT_RUN=1 exec ${AOC_AGENT_CMD:-${AOC_CODEX_CMD:-aoc-agent-run}}"
            }

            pane size="38%" name="Tasks" {
              plugin location="file:/home/ceii/.config/zellij/plugins/aoc-taskmaster.wasm" {
                refresh_secs "5"
              }
            }
          }

          // RIGHT COLUMN: Widget (top), Clock (center), Terminal (bottom)
          pane size="26%" split_direction="horizontal" {
            pane size="34%" name="Widget" command="bash" {
              args "-lc" "root_file=\"__AOC_PROJECT_ROOT_FILE__\"; root=\"__AOC_PROJECT_ROOT__\"; if [[ -f \"$root_file\" ]]; then root=\"$(cat \"$root_file\")\"; fi; cd \"$root\" && exec ${AOC_WIDGET_CMD:-aoc-widget}"
            }
            pane size="18%" name="Clock" command="bash" {
              args "-lc" "AOC_CLOCK_IN_PANE=1 exec ${AOC_CLOCK_CMD:-aoc-clock}"
            }
            pane size="48%" command="bash" {
              args "-lc" "root_file=\"__AOC_PROJECT_ROOT_FILE__\"; root=\"__AOC_PROJECT_ROOT__\"; if [[ -f \"$root_file\" ]]; then root=\"$(cat \"$root_file\")\"; fi; cd \"$root\" && exec ${AOC_TERMINAL_CMD:-$SHELL}"
            }
          }
        }
      }
    }
  }
}
